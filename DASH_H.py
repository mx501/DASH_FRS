from pandas.tseries.offsets import DateOffset
from datetime import datetime, timedelta, time
from pandas.tseries.offsets import MonthBegin
import os
import pandas as pd
from tqdm.auto import tqdm
import openai
import sys
import math
import gc
import requests
# from memory_profiler import profile
import numpy as np
import calendar
import winsound
pd.set_option("expand_frame_repr", False)
pd.set_option('display.max_colwidth', None)
gc.enable()


# –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å –ª–∏ –≤ –≥—Ä—É–ø–ø—É –≤–µ—á–µ—Ä–∏–Ω–∫–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–≤ –°–æ–æ–±—â–µ–Ω–∏—è?
BOT_ANALITIK = "n"

# —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö home –∏–ª–∏ work
geo = "h"
if geo == "h":
    # –æ—Å–Ω–æ–≤–Ω–æ–π –∫–∞—Ç–∞–ª–æ–≥ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–∞—à–±–æ—Ä–¥–∞
    PUT = "D:\\Python\\Dashboard\\"
    # –ø—É—Ç—å –¥–æ —Ñ–∞–π–ª–æ–≤ —Å –¥–∞–Ω–Ω—ã–º–∏ –æ –ø—Ä–æ–¥–∞–∂–∞—Ö
    PUT_PROD = PUT + "–ü–£–¢–¨ –î–û –§–ê–ô–õ–û–í –° –ü–†–û–î–ê–ñ–ê–ú–ò\\–¢–µ–∫—É—â–∏–π –≥–æ–¥\\"
else:
    # –æ—Å–Ω–æ–≤–Ω–æ–π –∫–∞—Ç–∞–ª–æ–≥ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–∞—à–±–æ—Ä–¥–∞
    PUT = "C:\\Users\\lebedevvv\\Desktop\\Dashboard\\"
    # –ø—É—Ç—å –¥–æ —Ñ–∞–π–ª–æ–≤ —Å –¥–∞–Ω–Ω—ã–º–∏ –æ –ø—Ä–æ–¥–∞–∂–∞—Ö
    PUT_PROD = "C:\\Users\\lebedevvv\\Desktop\\–ü–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –§–†–°\\–ü—Ä–æ–¥–∞–∂–∏, –°–ø–∏—Å–∞–Ω–∏—è, –ü—Ä–∏–±—ã–ª—å\\–¢–µ–∫—É—â–∏–π –≥–æ–¥\\"
    PUT_CHEK = "C:\\Users\\lebedevvv\\Desktop\\–ü–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –§–†–°\\–ß–ï–ö–ò\\2023\\"

# region –∫–æ–º–µ–º–µ–Ω—Ç–∞—Ä–∏–∏
'''–æ–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ'''
'''–º–∏–Ω–∏ –¥–∞—à–±–æ—Ä–¥ –¥–ª—è —Ç—É'''
'''–†–∞–∑–¥–µ–ª–∏—Ç—å –≤ –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤ –Ω–∞ —Ö–æ–∑—ã –∏ –Ω–µ'''
'''–∞–Ω–æ–º–∞–ª—å–Ω—ã–µ —Å–Ω–∏–∂–µ–Ω–∏—è —Ä–æ—Å—Ç –æ—Ç—Å–ª –¥–æ–±–∞–≤–∏—Ç—å'''
'''–û—à–∏–±–∫–∏ –ø–æ —Å—Ç–æ–∫–∞–º –∏ —Å—Ç–∞—Ç—å—è–º'''
'''—á–µ–∫–æ–≤ –Ω–∞ —Å–µ—Ç'''
# endregion
# region –û–ë–ù–û–í–õ–ï–ù–ò–ï –ò–°–¢–û–†–ò–ò
HISTORY = "n"
# endregion

class RENAME:
    def Rread(self):
        replacements = pd.read_excel(PUT + "DATA_2\\–î–õ–Ø –ó–ê–ú–ï–ù–´.xlsx",
                                     sheet_name="–õ–∏—Å—Ç1")
        rng = len(replacements)
        return rng, replacements
    '''–±–ª–æ–∫ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è'''
    def HOZY(self):
        Spisania_HOZI = pd.read_csv(PUT + "—Ö–æ–∑—ã —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫\\1.txt", sep="\t", encoding='utf-8', skiprows=8,
                                    names=("–º–∞–≥–∞–∑–∏–Ω", "–ù–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–∞", "–°—É–º–º–∞", "–°—É–º–º–∞ –±–µ–∑ –ù–î–°"))
        Spisania_HOZI = Spisania_HOZI["–ù–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–∞"].unique()
        return Spisania_HOZI
    '''–±–ª–æ–∫ —Ö–æ–∑—ã'''
"""—á—Ç–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –¥–ª—è –∑–∞–º–µ–Ω—ã –Ω–∞–∑–∞–Ω–∏ –º–∞–≥–∞–∑–∏–Ω–æ–≤ –∏ –±–∞–∑—ã –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä—ã —Ö–æ–∑ –æ–≤–∞—Ä–æ–≤"""
class DOC:
    def to(self, x, name):
        x.to_csv(PUT + "RESULT\\" + name, encoding="ANSI", sep=';',
                 index=False, decimal='.')
        return x

    def to_POWER_BI(self, x, name):
        x.to_csv(PUT + "RESULT\\" + name, encoding="ANSI", sep=';',
                 index=False, decimal=',')

    def to_ERROR(self, x, name):
        x.to_csv(PUT + "ERROR\\" + name, encoding="ANSI", sep=';',
                 index=False, decimal=',')

    def to_TEMP_txt(self, x, name):
        x.to_csv(PUT + "TEMP\\" + name, encoding="utf-8", sep='\t',
                 index=False, decimal='.')

    def to_TEMP(self, x, name):
        x.to_csv(PUT + "TEMP\\" + name, encoding="ANSI", sep=';',
                 index=False, decimal='.')
    def to_exel(self, x, name):
        x.to_excel(PUT + "TEMP\\" + name, index=False)
"""—Ñ—É–Ω–∫—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤ –ø–æ –ø–∞–ø–∫–∞–º"""
class BOT:
    def bot_mes(self, mes):
        # –ø–æ–ª—É—á–µ–Ω–∏–µ –∫–ª—é—á–µ–π
        dat = pd.read_excel(PUT + 'TEMP\\id.xlsx')
        keys_dict = dict(zip(dat.iloc[:, 0], dat.iloc[:, 1]))
        token = keys_dict.get('token')
        test = keys_dict.get('test')
        url = f'https://api.telegram.org/bot{token}/sendMessage'
        # –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è
        params = {'chat_id': test, 'text':mes}

        # –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä Telegram –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è
        response = requests.post(url, data=params)
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–≤–µ—Ç–∞ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞ Telegram

        if response.status_code == 200:
            print('–°–æ–æ–±—â–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ!')
        else:
            print(f'–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è: {response.status_code}')
            """–æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π"""
    def bot_mes_analitik(self, mes):
        dat = pd.read_excel(PUT + 'TEMP\\id.xlsx')
        # –°–æ–∑–¥–∞–µ–º —Å–ª–æ–≤–∞—Ä—å –∫–ª—é—á–µ–π
        keys_dict = dict(zip(dat.iloc[:, 0], dat.iloc[:, 1]))
        # –ü–æ–ª—É—á–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ id
        token = keys_dict.get('token')
        analitik = keys_dict.get('analitik')

        url = f'https://api.telegram.org/bot{token}/sendMessage'

        # –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è
        params = {'chat_id': analitik, 'text':mes}

        # –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä Telegram –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è
        response = requests.post(url, data=params)
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–≤–µ—Ç–∞ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞ Telegram

        if response.status_code == 200:
            print('–°–æ–æ–±—â–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ!')
        else:
            print(f'–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è: {response.status_code}')
    def bot_raschet(self):
        # region –î–õ–Ø –ë–û–¢–ê#######################################################################################################################


        PROD_SVOD_BOT = PROD_SVOD[["–¥–∞—Ç–∞", "–º–∞–≥–∞–∑–∏–Ω", "–í—ã—Ä—É—á–∫–∞ –ò—Ç–æ–≥–æ, —Ä—É–± —Å –ù–î–°", "–Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–∞", "–°–ø–∏—Å–†—É–±", "–æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–ø–∏—Å–∞–Ω–∏—è"]]

        PROD_SVOD_BOT = PROD_SVOD_BOT.groupby(["–¥–∞—Ç–∞", "–º–∞–≥–∞–∑–∏–Ω","–Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–∞","–æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–ø–∏—Å–∞–Ω–∏—è"]).sum().reset_index()
        # –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–∞ —Å–ø–∏—Å–∞–Ω–∏—è —Ç–∞–∫ –∫–∞–∫ –æ–Ω –Ω–µ –Ω—É–∂–µ–Ω –ø—Ä–∏ –¥–∞–ª—å–Ω–µ–π—à–∏—Ö —Ä–∞—Å—á–µ—Ç–∞—Ö
        BOT_NUM_HOZ = PROD_SVOD_BOT.loc[PROD_SVOD_BOT["–æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–ø–∏—Å–∞–Ω–∏—è"] == "–•–æ–∑—è–π—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã"]

        # –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–µ –∏ –º–µ—Å—è—Ü—É, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Å–ø–∏—Å–∞–Ω–∏—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–µ—Å—è—Ü–∞.
        monthly_mean = BOT_NUM_HOZ.groupby(['–Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–∞', BOT_NUM_HOZ['–¥–∞—Ç–∞'].dt.month])['–°–ø–∏—Å–†—É–±'].mean().reset_index()
        monthly_mean.columns = ['–Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–∞', '–º–µ—Å—è—Ü', 'mean']

        # –û–±—ä–µ–¥–∏–Ω—è–µ–º –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å–æ –≤—Å–µ–º–∏ –¥–∞–Ω–Ω—ã–º–∏.
        BOT_NUM_HOZ = pd.merge(BOT_NUM_HOZ, monthly_mean, on=['–Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–∞', BOT_NUM_HOZ['–¥–∞—Ç–∞'].dt.month], how='left')

        # –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è —Å–ø–∏—Å–∞–Ω–∏—è –æ—Ç —Å—Ä–µ–¥–Ω–µ–º–µ—Å—è—á–Ω–æ–≥–æ.
        BOT_NUM_HOZ['–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ'] = (BOT_NUM_HOZ['–°–ø–∏—Å–†—É–±'] - BOT_NUM_HOZ['mean']) / BOT_NUM_HOZ['mean']

        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∞–Ω–æ–º–∞–ª–∏–∏ –∫–∞–∫ –∑–Ω–∞—á–µ–Ω–∏—è, –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –∫–æ—Ç–æ—Ä—ã—Ö –±–æ–ª—å—à–µ —á–µ–º –Ω–∞ 20% –æ—Ç —Å—Ä–µ–¥–Ω–µ–º–µ—Å—è—á–Ω–æ–≥–æ.
        anomalies = BOT_NUM_HOZ[BOT_NUM_HOZ['–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ'].abs() > 0.2]

        # –í—ã–≤–æ–¥–∏–º –¥–∞–Ω–Ω—ã–µ –ø–æ –∞–Ω–æ–º–∞–ª–∏—è–º.
        anomalies = anomalies[['–¥–∞—Ç–∞', '–º–∞–≥–∞–∑–∏–Ω', '–Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–∞', '–°–ø–∏—Å–†—É–±']]
        print(anomalies)

        BOT_UNICK = 0
        BOT_BEST = 0

        BOT().to_day()
        # endregion#########################################################################################################################

    def to_day(self):
        rng, replacements = RENAME().Rread()
        # —Å—á–∏—Ç—ã–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ñ–∞–π–ª–∞
        PROD_SVOD = pd.read_csv(PUT + "TEMP\\" + "BOT_TEMP.csv", encoding="ANSI", sep=';', parse_dates=['–¥–∞—Ç–∞'])
        PROD_SVOD = PROD_SVOD.rename(columns={"–í—ã—Ä—É—á–∫–∞ –ò—Ç–æ–≥–æ, —Ä—É–± —Å –ù–î–°": "–í—ã—Ä—É—á–∫–∞","–°–ø–∏—Å–†—É–±": "–°–ø–∏—Å–∞–Ω–∏—è" })
        print(PROD_SVOD)
        PROD_SVOD_prmon = PROD_SVOD.copy()

        PROD_SVOD["–º–µ—Å—è—Ü"] = PROD_SVOD["–¥–∞—Ç–∞"].dt.month
        max_mes = PROD_SVOD["–º–µ—Å—è—Ü"].max()

        PROD_SVOD_prmon = PROD_SVOD.copy()

        PROD_SVOD = PROD_SVOD.loc[PROD_SVOD["–º–µ—Å—è—Ü"] == max_mes]
        PROD_SVOD["–¥–µ–Ω—å"] = PROD_SVOD["–¥–∞—Ç–∞"].dt.day
        max_day = PROD_SVOD["–¥–µ–Ω—å"].max()

        PROD_SVOD_prmon = PROD_SVOD_prmon.loc[PROD_SVOD_prmon["–º–µ—Å—è—Ü"] == max_mes-1]
        PROD_SVOD_prmon["–¥–µ–Ω—å"] = PROD_SVOD_prmon["–¥–∞—Ç–∞"].dt.day
        PROD_SVOD_prmon = PROD_SVOD_prmon.loc[PROD_SVOD_prmon["–¥–µ–Ω—å"] <= max_day]

        PROD_SVOD_prmon = PROD_SVOD_prmon.rename(columns={"–í—ã—Ä—É—á–∫–∞": "–í—ã—Ä—É—á–∫–∞ –ø—Ä–æ—à–ª—ã–π –º–µ—Å—è—Ü", "–°–ø–∏—Å–∞–Ω–∏—è" :"–°–ø–∏—Å–∞–Ω–∏—è –ø—Ä–æ—à–ª—ã–π –º–µ—Å—è—Ü"})


        PROD_SVOD = pd.merge(PROD_SVOD, PROD_SVOD_prmon, on=['–º–∞–≥–∞–∑–∏–Ω', '–¥–µ–Ω—å'], how='left')
        ren_mes = {
            1: '–Ø–Ω–≤–∞—Ä—å',
            2: '–§–µ–≤—Ä–∞–ª—å',
            3: '–ú–∞—Ä—Ç',
            4: '–ê–ø—Ä–µ–ª—å',
            5: '–ú–∞–π',
            6: '–ò—é–Ω—å',
            7: '–ò—é–ª—å',
            8: '–ê–≤–≥—É—Å—Ç',
            9: '–°–µ–Ω—Ç—è–±—Ä—å',
            10: '–û–∫—Ç—è–±—Ä—å',
            11: '–ù–æ—è–±—Ä—å',
            12: '–î–µ–∫–∞–±—Ä—å'}
        PROD_SVOD.loc[:, '–º–µ—Å—è—Ü –Ω–∞–∑–≤–∞–Ω–∏–µ'] = PROD_SVOD['–¥–∞—Ç–∞_x'].dt.month.replace(ren_mes)
        PROD_SVOD = PROD_SVOD.drop(columns={"–¥–∞—Ç–∞_x","–º–µ—Å—è—Ü_x","–¥–∞—Ç–∞_y","–º–µ—Å—è—Ü_y"})
        ty  =  pd.read_excel("https://docs.google.com/spreadsheets/d/1rwsBEeK_dLdpJOAXanwtspRF21Z3kWDvruani53JpRY/export?exportFormat=xlsx")
        ty = ty[["–ù–∞–∑–≤–∞–Ω–∏–µ 1 –° (–¥–ª—è —Ñ–∏–Ω —Ä–µ–∑–∞)","–ú–µ–Ω–µ–¥–∂–µ—Ä"]]

        for i in tqdm(range(rng), desc="–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ–°–ø–∏—Å–æ–∫ –¢–£ - ", colour="#808080"): ty["–ù–∞–∑–≤–∞–Ω–∏–µ 1 –° (–¥–ª—è —Ñ–∏–Ω —Ä–µ–∑–∞)"] = \
            ty["–ù–∞–∑–≤–∞–Ω–∏–µ 1 –° (–¥–ª—è —Ñ–∏–Ω —Ä–µ–∑–∞)"].str.replace(replacements["–ù–ê–ô–¢–ò"][i], replacements["–ó–ê–ú–ï–ù–ò–¢–¨"][i], regex=False)
        ty = ty.rename(columns={"–ù–∞–∑–≤–∞–Ω–∏–µ 1 –° (–¥–ª—è —Ñ–∏–Ω —Ä–µ–∑–∞)": '–º–∞–≥–∞–∑–∏–Ω'})

        PROD_SVOD = pd.merge(PROD_SVOD, ty, on=['–º–∞–≥–∞–∑–∏–Ω'], how='left')

        obshee = PROD_SVOD.groupby(["–º–µ—Å—è—Ü –Ω–∞–∑–≤–∞–Ω–∏–µ"], as_index=False) \
            .aggregate({"–í—ã—Ä—É—á–∫–∞":"sum","–°–ø–∏—Å–∞–Ω–∏—è":"sum" ,"–í—ã—Ä—É—á–∫–∞ –ø—Ä–æ—à–ª—ã–π –º–µ—Å—è—Ü":"sum","–°–ø–∏—Å–∞–Ω–∏—è –ø—Ä–æ—à–ª—ã–π –º–µ—Å—è—Ü":"sum"}) \
            .sort_values("–í—ã—Ä—É—á–∫–∞", ascending=False)

        po_ty = PROD_SVOD.groupby(["–ú–µ–Ω–µ–¥–∂–µ—Ä"], as_index=False) \
            .aggregate({"–í—ã—Ä—É—á–∫–∞":"sum","–°–ø–∏—Å–∞–Ω–∏—è":"sum" ,"–í—ã—Ä—É—á–∫–∞ –ø—Ä–æ—à–ª—ã–π –º–µ—Å—è—Ü":"sum","–°–ø–∏—Å–∞–Ω–∏—è –ø—Ä–æ—à–ª—ã–π –º–µ—Å—è—Ü":"sum"}) \
            .sort_values("–í—ã—Ä—É—á–∫–∞", ascending=False)

        po_ty['–ò–∑–º–µ–Ω–µ–Ω–∏–µ –≤—ã—Ä—É—á–∫–∏'] = pd.to_numeric(po_ty['–í—ã—Ä—É—á–∫–∞']) - pd.to_numeric(po_ty['–í—ã—Ä—É—á–∫–∞ –ø—Ä–æ—à–ª—ã–π –º–µ—Å—è—Ü'])
        po_ty['–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞—Å—Ö–æ–¥–æ–≤'] = pd.to_numeric(po_ty['–°–ø–∏—Å–∞–Ω–∏—è']) - pd.to_numeric(po_ty['–°–ø–∏—Å–∞–Ω–∏—è –ø—Ä–æ—à–ª—ã–π –º–µ—Å—è—Ü'])
        # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ª—É—á—à–∏—Ö –∏ —Ö—É–¥—à–∏—Ö –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤:
        best_manager = po_ty.loc[po_ty['–ò–∑–º–µ–Ω–µ–Ω–∏–µ –≤—ã—Ä—É—á–∫–∏'] == po_ty['–ò–∑–º–µ–Ω–µ–Ω–∏–µ –≤—ã—Ä—É—á–∫–∏'].max()]['–ú–µ–Ω–µ–¥–∂–µ—Ä'].values[0]
        worst_manager = po_ty.loc[po_ty['–ò–∑–º–µ–Ω–µ–Ω–∏–µ –≤—ã—Ä—É—á–∫–∏'] == po_ty['–ò–∑–º–µ–Ω–µ–Ω–∏–µ –≤—ã—Ä—É—á–∫–∏'].min()]['–ú–µ–Ω–µ–¥–∂–µ—Ä'].values[0]

        best_manager_spis = po_ty.loc[po_ty['–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞—Å—Ö–æ–¥–æ–≤'] == po_ty['–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞—Å—Ö–æ–¥–æ–≤'].max()]['–ú–µ–Ω–µ–¥–∂–µ—Ä'].values[0]
        worst_manager_spis = po_ty.loc[po_ty['–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞—Å—Ö–æ–¥–æ–≤'] == po_ty['–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞—Å—Ö–æ–¥–æ–≤'].min()]['–ú–µ–Ω–µ–¥–∂–µ—Ä'].values[0]
        #print(po_ty)

        # –í—ã—Ä—É—á–∫–∞ –ò–∑–º–µ–Ω–µ–Ω–µ –∫ –ø—Ä–æ—à–ª–æ–º—É –º–µ—Å—è—Ü—É –ª—É—á—à–µ–≥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞
        izm_vit_best  = po_ty.loc[po_ty['–ú–µ–Ω–µ–¥–∂–µ—Ä'] == best_manager]
        izm_vit_best = izm_vit_best['–ò–∑–º–µ–Ω–µ–Ω–∏–µ –≤—ã—Ä—É—á–∫–∏'].sum()
        # –°–ø–∏—Å–∞–Ω–∏—è –ò–∑–º–µ–Ω–µ–Ω–µ –∫ –ø—Ä–æ—à–ª–æ–º—É –º–µ—Å—è—Ü—É –ª—É—á—à–µ–≥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞
        izm_spis_best = po_ty.loc[po_ty['–ú–µ–Ω–µ–¥–∂–µ—Ä'] == best_manager_spis]
        izm_spis_best = izm_spis_best['–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞—Å—Ö–æ–¥–æ–≤'].sum()

        # –í—ã—Ä—É—á–∫–∞ –ò–∑–º–µ–Ω–µ–Ω–µ –∫ –ø—Ä–æ—à–ª–æ–º—É –º–µ—Å—è—Ü—É —Ö—É–¥—â–µ–≥–æ
        izm_vit_hyd = po_ty.loc[po_ty['–ú–µ–Ω–µ–¥–∂–µ—Ä'] == worst_manager]
        izm_vit_hyd = izm_vit_hyd['–ò–∑–º–µ–Ω–µ–Ω–∏–µ –≤—ã—Ä—É—á–∫–∏'].sum()
        # –°–ø–∏—Å–∞–Ω–∏—è –ò–∑–º–µ–Ω–µ–Ω–µ –∫ –ø—Ä–æ—à–ª–æ–º—É –º–µ—Å—è—Ü—É –ª—É—á—à–µ–≥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞
        izm_spis_hyd = po_ty.loc[po_ty['–ú–µ–Ω–µ–¥–∂–µ—Ä'] == worst_manager_spis]
        izm_spis_hyd = izm_spis_hyd['–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞—Å—Ö–æ–¥–æ–≤'].sum()

        # –í—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –¥–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤:
        izm_spis_hyd = format(izm_spis_hyd, ',.2f').replace(',', ' ').replace('.', ',')
        izm_spis_best = format(izm_spis_best, ',.2f').replace(',', ' ').replace('.', ',')
        izm_vit_hyd = format(izm_vit_hyd, ',.2f').replace(',', ' ').replace('.', ',')
        izm_vit_best  = format(izm_vit_best, ',.2f').replace(',', ' ').replace('.', ',')
        mes_bot = \
        ("   –ú–µ–Ω–µ–¥–∂–µ—Ä—ã   \n"
        f"üí∞ –í—ã—Ä—É—á–∫–∞\n"
        f"‚Ä¢ –õ–∏–¥–µ—Ä—ã: {best_manager}\n"
        f"‚Ä¢ –ò–∑–º–µ–Ω–µ–Ω–µ –∫ –ø—Ä–æ—à–ª–æ–º—É –º–µ—Å—è—Ü—É: {izm_vit_best}\n"
        f"‚Ä¢ –ß—É—Ç—å-—á—É—Ç—å –æ—Ç—Å—Ç–∞—é—Ç: {worst_manager}\n"
        f"‚Ä¢ –ò–∑–º–µ–Ω–µ–Ω–µ –∫ –ø—Ä–æ—à–ª–æ–º—É –º–µ—Å—è—Ü—É: {izm_vit_hyd}\n"
        f"\n"
        f"üí∏ –°–ø–∏—Å–∞–Ω–∏—è\n"
        f"‚Ä¢ –õ–∏–¥–µ—Ä—ã: {worst_manager_spis}\n"
        f"‚Ä¢ –ò–∑–º–µ–Ω–µ–Ω–µ –∫ –ø—Ä–æ—à–ª–æ–º—É –º–µ—Å—è—Ü—É: {izm_spis_hyd}\n"
        f"‚Ä¢ –ß—É—Ç—å-—á—É—Ç—å –æ—Ç—Å—Ç–∞—é—Ç: {best_manager_spis}\n"
        f"‚Ä¢ –ò–∑–º–µ–Ω–µ–Ω–µ –∫ –ø—Ä–æ—à–ª–æ–º—É –º–µ—Å—è—Ü—É: {izm_spis_best}\n")
        # –ø–æ–¥—Å—á–µ—Ç –∫–æ–ª–ª–∏—á–µ—Å—Ç–≤–∞ –º–∞–≥–∞–∑–∏–Ω–æ–≤
        MAG_CUNT = pd.read_csv(PUT + "TEMP\\" + "BOT\\–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –º–∞–≥–∞–∑–∏–Ω—ã.csv", encoding="ANSI", sep=';')
        MAG_CUNT  = MAG_CUNT["–º–∞–≥–∞–∑–∏–Ω"].count()
        MAG_CUNT  =(f"üõí –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∞–≥–∞–∑–∏–Ω–æ–≤ —Å–µ–≥–æ–¥–Ω—è:  {MAG_CUNT}")

        BOT().bot_mes(mes=mes_bot)
        BOT().bot_mes(mes=MAG_CUNT)
        if BOT_ANALITIK == "y":
            BOT().bot_mes_analitik(mes=mes_bot)
            BOT().bot_mes_analitik(mes=MAG_CUNT)

        return mes_bot
    """–µ–∂–µ–¥–Ω–µ–≤–Ω–æ–µ –∏–Ω—Ñ–æ"""
    def open_ai(self):
        df = BOT().to_day()
        # region API_K
        dat = pd.read_excel(PUT + 'TEMP\\id.xlsx')
        keys_dict = dict(zip(dat.iloc[:, 0], dat.iloc[:, 1]))
        openai.api_key = keys_dict.get('API')
        # endregion
        def generate_table_description(df):
            prompt = f"–≤—ã–≤–µ–¥–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã—Ö –∏ –ø–æ–ª—É—á–µ–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤" \
                     f":\n\n{df}\n\n–Ω–∞ —Ä—É—Å–∫–æ–º"
            response = openai.Completion.create(
                engine="text-curie-001",
                prompt=prompt,
                max_tokens=1024,
                n=1,
                stop=None,
                temperature=0.5,)

            description = response.choices[0].text.strip()
            return description

        # –†–∞—Å—á–µ—Ç —Ä–∞–∑–Ω–∏—Ü—ã –º–µ–∂–¥—É —Ç–µ–∫—É—â–∏–º –∏ –ø—Ä–æ—à–ª—ã–º –º–µ—Å—è—Ü–µ–º:
        df['–ò–∑–º–µ–Ω–µ–Ω–∏–µ –≤—ã—Ä—É—á–∫–∏'] = pd.to_numeric(df['–í—ã—Ä—É—á–∫–∞']) - pd.to_numeric(df['–í—ã—Ä—É—á–∫–∞ –ø—Ä–æ—à–ª—ã–π –º–µ—Å—è—Ü'])
        df['–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞—Å—Ö–æ–¥–æ–≤'] = pd.to_numeric(df['–°–ø–∏—Å–∞–Ω–∏—è']) - pd.to_numeric(df['–°–ø–∏—Å–∞–Ω–∏—è –ø—Ä–æ—à–ª—ã–π –º–µ—Å—è—Ü'])

        # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ª—É—á—à–∏—Ö –∏ —Ö—É–¥—à–∏—Ö –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤:
        best_manager = df.loc[df['–ò–∑–º–µ–Ω–µ–Ω–∏–µ –≤—ã—Ä—É—á–∫–∏'] == df['–ò–∑–º–µ–Ω–µ–Ω–∏–µ –≤—ã—Ä—É—á–∫–∏'].max()]['–ú–µ–Ω–µ–¥–∂–µ—Ä'].values[0]
        worst_manager = df.loc[df['–ò–∑–º–µ–Ω–µ–Ω–∏–µ –≤—ã—Ä—É—á–∫–∏'] == df['–ò–∑–º–µ–Ω–µ–Ω–∏–µ –≤—ã—Ä—É—á–∫–∏'].min()]['–ú–µ–Ω–µ–¥–∂–µ—Ä'].values[0]

        # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ–ø–∏—Å–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã:
        description = response.choices[0].text

        # –í—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:
        print(description)
        print('\n')
        print(f"Best Manager: {best_manager}")
        print(f"Worst Manager: {worst_manager}")
    def open_ai_curi(self):
        mes_bot = BOT().to_day()
        # region API_K
        dat = pd.read_excel(PUT + 'TEMP\\id.xlsx')
        keys_dict = dict(zip(dat.iloc[:, 0], dat.iloc[:, 1]))
        openai.api_key = keys_dict.get('API')
        # endregion
        # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –∑–∞–ø—Ä–æ—Å–∞
        request = mes_bot
        # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞
        response = openai.Completion.create(
            engine="text-davinci-003",
            prompt=(f"–°–æ—Å—Ç–∞–≤—å —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è —Ç–µ–ª–µ–≥—Ä–∞–º, –ø—Ä–∏–º–µ–Ω–∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫—Ä–∞—Å–∏–≤–æ–µ, –¥–ª—è —Ö—É–¥—à–∏—Ö –∫—Ä–∞—Å–Ω—ã–µ —Å–º–∞—Ü–ª—ã –¥–ª—è –ª—É–¥—à–∏—Ö –∑–µ–ª–µ–Ω—ã–µ:\n{request}\n\n"),
            max_tokens=1000,
            temperature = 0.5)
        # –ü–æ–ª—É—á–µ–Ω–∏–µ –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
        formatted_text = response.choices[0].text.strip()

        # –í—ã–≤–æ–¥ –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
        BOT().bot_mes(mes=formatted_text)

    """–ê–≤—Ç–æ–æ–ø–∏—Å–∞–Ω–∏–µ"""
"""–ë–æ—Ç —Ç–µ–ª–µ–≥—Ä–∞–º"""
#BOT().bot_mes(mes="—Ç–µ—Å—Ç")
class NEW:
    def STATYA(self):
        STATYA = pd.read_excel(PUT + "DATA_2\\" + "@–°–ü–†–ê–í–û–ß–ù–ò–ö_–°–¢–ê–¢–ï–ô.xlsx",
                               sheet_name="STATYA_REDAKT")
        return STATYA
    '''—Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —Å—Ç–∞—Ç–µ–π_—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç—Å—è –≤ –µ–∫—Å–µ–ª—å'''
    def Dat_nalog_kanal(self):
        Dat_canal_nalg = pd.read_csv(PUT + "TEMP\\" + "–î–∞—Ç–∞_–∫–∞–Ω–∞–ª_–Ω–∞–ª–æ–≥.csv",
                                     sep=";", encoding='ANSI', parse_dates=['–¥–∞—Ç–∞'])
        # –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –º–µ—Å—ã—è—Ü–∞
        finrez_max_month = Dat_canal_nalg[["–¥–∞—Ç–∞"]]
        finrez_max_month = finrez_max_month.reset_index(drop=True)
        finrez_max_month = finrez_max_month.loc[finrez_max_month['–¥–∞—Ç–∞'] >= "2023-01-01"]
        finrez_max_month = finrez_max_month.reset_index(drop=True)
        finrez_max_month['–º–µ—Å—è—Ü'] = finrez_max_month['–¥–∞—Ç–∞'].dt.month
        finrez_max_month = finrez_max_month['–º–µ—Å—è—Ü'].max()
        # –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –¥–∞—Ç—ã –≤ —Ñ–æ—Ä–º–∞—Ç–µ –≥–≥–≥–≥-–º–º-–¥–¥
        finrez_max_data = Dat_canal_nalg[["–¥–∞—Ç–∞"]]
        finrez_max_data = finrez_max_data.reset_index(drop=True)
        finrez_max_data = finrez_max_data.loc[finrez_max_data['–¥–∞—Ç–∞'] >= "2023-01-01"]
        finrez_max_data = finrez_max_data.reset_index(drop=True)
        finrez_max_data['–¥–∞—Ç–∞'] = finrez_max_data['–¥–∞—Ç–∞'].dt.date
        finrez_max_data = finrez_max_data['–¥–∞—Ç–∞'].max()
        finrez_max_data = pd.to_datetime(finrez_max_data)
        print("–ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∫–∞–Ω–∞–ª–æ–≤ –∏ —Ä–µ–∂–∏–º–∞ –Ω–∞–ª–æ–≥–∞, –ø–æ–ª—É—á–µ–Ω–∏–µ –º–∞–∫—Å –¥–∞—Ç—ã")
        return Dat_canal_nalg, finrez_max_month, finrez_max_data
    '''–æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –∑–∞–≥—Ä—É–∑–∫—É –¥–∞–Ω–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤ –∏ —Ä–µ–∂–∏–º–∞ –Ω–∞–ª–æ–≥–∞, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –¥–∞—Ç—ã –∏ –º–µ—Å—è—Ü–∞'''
    def Finrez(self):
        rng, replacements = RENAME().Rread()
        print(
            "–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ–∏–Ω—Ä–µ–∑–∞\n")
        for files in os.listdir(PUT + "DATA\\"):
            FINREZ = pd.read_excel(PUT + "DATA\\" + files, sheet_name="–î–∏–Ω–∞–º–∏–∫–∞ –¢–¢ –∏—Å—Ö–æ–¥–Ω–∏–∫")
            FINREZ = FINREZ.rename(columns={"–¢–æ—Ä–≥–æ–≤–∞—è —Ç–æ—á–∫–∞": "–º–∞–≥–∞–∑–∏–Ω", "–î–∞—Ç–∞": "–¥–∞—Ç–∞",
                                            "–ö–∞–Ω–∞–ª": "–∫–∞–Ω–∞–ª",
                                            "–†–µ–∂–∏–º –Ω–∞–ª–æ–≥–æ–æ–±–ª–æ–∂–µ–Ω–∏—è": "—Ä–µ–∂–∏–º –Ω–∞–ª–æ–≥–æ–æ–±–ª–æ–∂–µ–Ω–∏—è",
                                            "–ö–∞–Ω–∞–ª –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –∑–∞–∫—Ä—ã—Ç—ã–π –ø–µ—Ä–∏–æ–¥": "–∫–∞–Ω–∞–ª –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –∑–∞–∫—Ä—ã—Ç—ã–π –ø–µ—Ä–∏–æ–¥"})
            print("—Ñ–∞–π–ª - ", files)
            for i in tqdm(range(rng), desc="–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–æ–≤   --  ", ncols=120, colour="#F8C9CE"):
                FINREZ["–º–∞–≥–∞–∑–∏–Ω"] = FINREZ["–º–∞–≥–∞–∑–∏–Ω"].replace(replacements["–ù–ê–ô–¢–ò"][i], replacements["–ó–ê–ú–ï–ù–ò–¢–¨"][i],
                                                              regex=False)
            FINREZ = FINREZ.reset_index(drop=True)
            FINREZ = FINREZ.loc[FINREZ['–¥–∞—Ç–∞'] >= "2022-01-01"]

            # region –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –∫–æ–ª–æ–Ω–æ–∫
            FINREZ_SPRAVOCHNIK_STATIYA = FINREZ.melt(
                id_vars=["–¥–∞—Ç–∞", "–º–∞–≥–∞–∑–∏–Ω", "—Ä–µ–∂–∏–º –Ω–∞–ª–æ–≥–æ–æ–±–ª–æ–∂–µ–Ω–∏—è", "–∫–∞–Ω–∞–ª", "–∫–∞–Ω–∞–ª –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –∑–∞–∫—Ä—ã—Ç—ã–π –ø–µ—Ä–∏–æ–¥"],
                var_name="—Å—Ç–∞—Ç—å—è",
                value_name="–∑–Ω–∞—á–µ–Ω–∏–µ")
            unique_values = FINREZ_SPRAVOCHNIK_STATIYA["—Å—Ç–∞—Ç—å—è"].unique()
            FINREZ_SPRAVOCHNIK_STATIYA = pd.DataFrame({'—Å—Ç–∞—Ç—å—è': unique_values})
            DOC().to_exel(x=FINREZ_SPRAVOCHNIK_STATIYA, name="–°–ø—Ä–∞–≤–æ–Ω–∏–∫ —Å—Ç–∞—Ç–µ–π.xlsx")
            # endregion
            # region –≤—ã–±–æ—Ä —Å—Ç–æ–ª–±—Ü–æ–≤ –≤ —Ñ–∞–π–ª–µ
            FINREZ = FINREZ[
                ["–¥–∞—Ç–∞", "–º–∞–≥–∞–∑–∏–Ω", "—Ä–µ–∂–∏–º –Ω–∞–ª–æ–≥–æ–æ–±–ª–æ–∂–µ–Ω–∏—è", "–∫–∞–Ω–∞–ª", "–∫–∞–Ω–∞–ª –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –∑–∞–∫—Ä—ã—Ç—ã–π –ø–µ—Ä–∏–æ–¥",
                 "–¢–æ–≤–∞—Ä–æ–æ–±–æ—Ä–æ—Ç (–ø—Ä–æ–¥–∞–∂–∏) –ú–ö–ü, –µ–¥", "–¢–æ–≤–∞—Ä–æ–æ–±–æ—Ä–æ—Ç (–ø—Ä–æ–¥–∞–∂–∏) –ú–ö–ü, —Ä—É–± —Å –ù–î–°",
                 "–¢–æ–≤–∞—Ä–æ–æ–±–æ—Ä–æ—Ç (–ø—Ä–æ–¥–∞–∂–∏) –ö–ü, –µ–¥",
                 "–¢–æ–≤–∞—Ä–æ–æ–±–æ—Ä–æ—Ç (–ø—Ä–æ–¥–∞–∂–∏) –ö–ü, —Ä—É–± —Å –ù–î–°", "–¢–æ–≤–∞—Ä–æ–æ–±–æ—Ä–æ—Ç (–ø—Ä–æ–¥–∞–∂–∏) —Å–æ–ø—É—Ç–∫–∞, –µ–¥",
                 "–¢–æ–≤–∞—Ä–æ–æ–±–æ—Ä–æ—Ç (–ø—Ä–æ–¥–∞–∂–∏) —Å–æ–ø—É—Ç–∫–∞, —Ä—É–± —Å –ù–î–°",
                 # ---–î–æ—Ö–æ–¥
                 "–í—ã—Ä—É—á–∫–∞ –ò—Ç–æ–≥–æ, —Ä—É–± –±–µ–∑ –ù–î–°",
                 "–ü—Ä–æ—á–∏–µ –¥–æ—Ö–æ–¥—ã (—Å—É–±–∞—Ä–µ–Ω–¥–∞), —Ä—É–± –±–µ–∑ –ù–î–°", "–ü—Ä–æ—á–∏–µ –¥–æ—Ö–æ–¥—ã (—É—Ç–∏–ª–∏–∑–∞—Ü–∏—è), —Ä—É–± –±–µ–∑ –ù–î–°",
                 "–î–æ—Ö–æ–¥ –æ—Ç –ø—Ä–æ–¥–∞–∂–∏ –¢–ú–¶, —Ä—É–± –±–µ–∑ –ù–î–°",
                 "–ü—Ä–æ—á–∏–µ –¥–æ—Ö–æ–¥—ã (–ø–∞—É—à–∞–ª—å–Ω—ã–π –≤–∑–Ω–æ—Å, —É—Å–ª—É–≥–∏ –ø–æ –æ—Ç–∫—Ä—ã—Ç–∏—é), —Ä—É–± –±–µ–∑ –ù–î–°", "–î–æ—Ö–æ–¥ –®—Ç—Ä–∞—Ñ—ã, —Ä—É–± –±–µ–∑ –ù–î–°",
                 "–î–æ—Ö–æ–¥ –ê—Ä–µ–Ω–¥–∞ –ø–æ–º–µ—â–µ–Ω–∏–π, —Ä—É–± –±–µ–∑ –ù–î–°",
                 "–î–æ—Ö–æ–¥ (–∞—Ä–µ–Ω–¥–∞ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è), —Ä—É–± –±–µ–∑ –ù–î–°", "–î–æ—Ö–æ–¥ –†–æ—è–ª—Ç–∏, —Ä—É–± –±–µ–∑ –ù–î–°",
                 "–î–æ—Ö–æ–¥ –∫–æ–º–∏—Å—Å–∏–æ–Ω–Ω–æ–µ –≤–æ–∑–Ω–∞–≥—Ä–∞–∂–¥–µ–Ω–∏–µ, —Ä—É–± –±–µ–∑ –ù–î–°",
                 "–î–æ—Ö–æ–¥ –£—Å–ª—É–≥–∏ –ø–æ –¥–æ–≥–æ–≤–æ—Ä—É –∫–æ–º–∏—Å—Å–∏–∏ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω, —Ä—É–± –±–µ–∑ –ù–î–°",
                 # ---–ó–∞–∫—É–ø
                 "* –ó–∞–∫—É–ø —Ç–æ–≤–∞—Ä–∞ (–ú–ö–ü, –ö–ü, —Å–æ–ø—É—Ç–∫–∞), —Ä—É–± –±–µ–∑ –ù–î–°",
                 # ---–ó–∞—Ç—Ä–∞—Ç—ã
                 "–û–ï - –û–±—â–∏–µ –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã (—Å—É–º–º–∞ –≤—Å–µ—Ö —Å—Ç–∞—Ç–µ–π —Ä–∞—Å—Ö–æ–¥–æ–≤), —Ä—É–± –±–µ–∑ –ù–î–°",
                 "2.1. –§–û–¢+–û—Ç—á–∏—Å–ª–µ–Ω–∏—è", "2.2. –ê—Ä–µ–Ω–¥–∞", "2.19. –ë–æ–Ω—É—Å—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏",
                 "2.3.1. –≠–ª–µ–∫—Ç—Ä–æ—ç–Ω–µ—Ä–≥–∏—è", "2.3.2. –í—ã–≤–æ–∑ –º—É—Å–æ—Ä–∞, –ñ–ë–û, –¢–ë–û",
                 "2.3.3. –¢–µ–ø–ª–æ–≤–∞—è —ç–Ω–µ—Ä–≥–∏—è",
                 "2.3.4. –í–æ–¥–æ—Å–Ω–∞–±–∂–µ–Ω–∏–µ",
                 "2.3.5. –í–æ–¥–æ–æ—Ç–≤–µ–¥–µ–Ω–∏–µ",
                 "2.3.6. –ü—Ä–æ—á–∏–µ –∫–æ–º–º—É–Ω–∞–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏ (–§–†–°)",
                 "2.3.7. –ì–∞–∑–æ—Å–Ω–∞–±–∂–µ–Ω–∏–µ",
                 "2.11. –ú–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—ã–µ —Ä–∞—Å—Ö–æ–¥—ã",
                 "2.9. –ù–∞–ª–æ–≥–∏",
                 "2.5.2. –ù–ï–£",
                 "2.10. –ü–∏—Ç–∞–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ ",
                 "2.17. –†–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ–º–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞",
                 "2.18. –ó–∞—Ç—Ä–∞—Ç—ã —Å–ª—É–∂–±—ã —Ä–∞–∑–≤–∏—Ç–∏—è",
                 "2.3.8. –û—Ö—Ä–∞–Ω–∞",
                 "2.4. –£—Å–ª—É–≥–∏ –±–∞–Ω–∫–∞",
                 "2.7. –ü—Ä–æ—á–∏–µ –ø—Ä—è–º—ã–µ –∑–∞—Ç—Ä–∞—Ç—ã",
                 "2.7.1. –î–µ–∑–∏–Ω—Ñ–µ–∫—Ü–∏–æ–Ω–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞",
                 "2.7.10. –£—Å–ª—É–≥–∏ —Å–æ—Ç–æ–≤–æ–π —Å–≤—è–∑–∏",
                 "2.7.2. –ö–∞–Ω—Ü–µ–ª—è—Ä—Å–∫–∏–µ —Ç–æ–≤–∞—Ä—ã",
                 "2.7.3. –ö–æ–º–∞–Ω–¥–∏—Ä–æ–≤–æ—á–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã",
                 "2.7.4. –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ —É—Å–ª—É–≥–∏, –º–µ–¥–∏–∫–∞–º–µ–Ω—Ç—ã, –º–µ–¥–æ—Å–º–æ—Ç—Ä—ã",
                 "2.7.5. –†–∞—Å—Ö–æ–¥—ã –Ω–∞ –∞—Ä–µ–Ω–¥—É –ø—Ä–æ—á–µ–≥–æ –∏–º—É—â–µ—Å—Ç–≤–∞",
                 "2.7.6. –°–ø–µ—Ü–æ–¥–µ–∂–¥–∞, —Å–ø–µ—Ü–æ–±—É–≤—å, –°–ò–ó",
                 "2.7.7. –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–µ —É—Å–ª—É–≥–∏",
                 "2.7.8. –ò–Ω—Ç–µ—Ä–Ω–µ—Ç",
                 "2.7.9. –£—Å–ª—É–≥–∏ –ø–æ –¥–µ—Ä–∞—Ç–∏–∑–∞—Ü–∏–∏, –¥–µ–∑–∏–Ω—Å–µ–∫—Ü–∏–∏",
                 "2.16. –†–æ—è–ª—Ç–∏",
                 "2.5.1. –°–ø–∏—Å–∞–Ω–∏–µ –ø–æ—Ç–µ—Ä—å (–¥–æ –Ω–æ—è–±—Ä—è 19–≥ –ù–ï–£ + –°–ø–∏—Å–∞–Ω–∏–µ –ø–æ—Ç–µ—Ä—å)",
                 "2.13. –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã/–∏–Ω–≤–µ–Ω—Ç–∞—Ä—å",
                 "2.14. –†–µ–º–æ–Ω—Ç –∏ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –∑–¥–∞–Ω–∏–π, –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è",
                 "2.15.–¢–û –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è (–∞—É—Ç—Å–æ—Ä—Å–∏–Ω–≥)",
                 "2.6. –•–æ–∑—è–π—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã",
                 "2.8. –¢–ú–¶ ",
                 "–†–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å, %",
                 "–ü—Ä–∏–±—ã–ª—å (+) / –£–±—ã—Ç–æ–∫ (-) (= –¢- –û–ï), —Ä—É–± –±–µ–∑ –ù–î–°",
                 "–ù–∞—Ü–µ–Ω–∫–∞ –û–±—â–∞—è, —Ä—É–± –±–µ–∑ –ù–î–°",
                 "–ù–∞—Ü–µ–Ω–∫–∞ –û–±—â–∞—è, %",
                 "–ù–∞—Ü–µ–Ω–∫–∞ –ú–ö–ü –∏ –ö–ü, —Ä—É–± —Å –ù–î–°",
                 "–ù–∞—Ü–µ–Ω–∫–∞ —Å–æ–ø—É—Ç–∫–∞, —Ä—É–± —Å –ù–î–°",
                 "–ù–∞—Ü–µ–Ω–∫–∞ –ú–ö–ü –∏ –ö–ü, %",
                 "–ù–∞—Ü–µ–Ω–∫–∞ —Å–æ–ø—É—Ç–∫–∞, %",
                 ##
                 "–î–æ–ª—è –∫–æ–ª–±–∞—Å–∞",
                 "–î–æ–ª—è –ø/—Ñ",
                 "–î–æ–ª—è  –≥—Ä–∏–ª—å",
                 "–î–æ–ª—è  –ö–æ—Å—Ç–∏ –ª–∏–≤–µ—Ä –æ—Ç—Ä—É–±–∞",
                 "–î–æ–ª—è –∫—É—Ä–∏–Ω—ã–µ –ø/—Ñ",
                 "–î–æ–ª—è —Å—É–±–ø—Ä–æ–¥—É–∫—Ç—ã –∫—É—Ä",
                 "–î–æ–ª—è —Å–æ–ø—É—Ç–∫–∞",
                 "–î–æ–ª—è –ö–∞–ª–∏–Ω–∞ –º–∞–ª–∏–Ω–∞",
                 "–î–æ–ª—è –∑–µ–ª–µ–Ω—ã–π –º–∞–≥–∞–∑–∏–Ω",
                 "–î–æ–ª—è –í–æ–ª–∫–æ–≤ –ö–æ—Ñ–µ",
                 "–î–æ–ª—è \"–ò–∑–≥–æ—Ç–æ–≤–ª–µ–Ω–æ –ø–æ –∑–∞–∫–∞–∑—É\"",
                 "–î–æ–ª—è –†—ã–±–Ω—ã–µ –ø/—Ñ",
                 "–î–æ–ª—è –ü—Ä–æ–¥—É–∫—Ü–∏—è –∫—É–ª–∏–Ω–∞—Ä–Ω–æ–≥–æ —Ü–µ—Ö–∞ –ö–•–í",
                 "–î–æ–ª—è –ü–µ–∫–∞—Ä–Ω—è",
                 # –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏
                 "–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ 3.1. –ú–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—ã–µ —Ä–∞—Å—Ö–æ–¥—ã",
                 "–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ 3.2. –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã/–∏–Ω–≤–µ–Ω—Ç–∞—Ä—å",
                 "–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ 3.3. –†–µ–º–æ–Ω—Ç –∏ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –∑–¥–∞–Ω–∏–π, –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è",
                 "3.3.1. –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ –Ω–∞ –ø–µ—Ä–µ—Ñ–æ—Ä–º–∞—Ç –∏ –æ—Ç–∫—Ä—ã—Ç–∏–µ",
                 "3.3.2. –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ –Ω–∞ –ø–µ—Ä–µ—Ñ–æ—Ä–º–∞—Ç –∏ –æ—Ç–∫—Ä—ã—Ç–∏–µ –û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ (—Ç–µ—Ö —Å–ª—É–∂–±–∞ –§–†–°)",
                 "3.3.3. –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ –Ω–∞ –ø–µ—Ä–µ—Ñ–æ—Ä–º–∞—Ç –∏ –æ—Ç–∫—Ä—ã—Ç–∏–µ –†–µ–º–æ–Ω—Ç (—Ç–µ—Ö —Å–ª—É–∂–±–∞ –§–†–°)",
                 "–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ 3.4. –¢–û –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è (–∞—É—Ç—Å–æ—Ä—Å–∏–Ω–≥)",
                 # —Ç–æ—á–∫–∞ –±–µ–∑—É–±—ã—Ç–æ—á–Ω–æ—Å—Ç–∏
                 "–¢–æ—á–∫–∞ –±–µ–∑—É–±—ã—Ç–æ—á–Ω–æ—Å—Ç–∏ (–ú–ö–ü, –ö–ü, –°–æ–ø—É—Ç–∫–∞), —Ä—É–± —Å –ù–î–°",
                 "–†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É —Ç–æ—á–∫–æ–π –±–µ–∑—É–±—ã—Ç–æ—á–Ω–æ—Å—Ç–∏ –∏ –æ–±—ä–µ–º–æ–º –ø—Ä–æ–¥–∞–∂, —Ä—É–± —Å –ù–î–°",
                 "–°—Ä–µ–¥–Ω–µ—Å–ø–∏—Å–æ—á–Ω–∞—è —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª–∞ –Ω–∞ –¢–¢",
                 "–°—Ä–µ–¥–Ω—è—è –∑/–ø–ª —Å –æ—Ç—á–∏—Å–ª–µ–Ω–∏—è–º–∏",
                 ###
                 "1.1.–ó–∞–∫—É–ø —Ç–æ–≤–∞—Ä–∞ (–ú–ö–ü –∏ –ö–ü), —Ä—É–± —Å –ù–î–°",
                 "1.2.–ó–∞–∫—É–ø —Ç–æ–≤–∞—Ä–∞ (—Å–æ–ø—É—Ç–∫–∞), —Ä—É–± —Å –ù–î–°",
                 "–í—ã—Ä—É—á–∫–∞ –ò—Ç–æ–≥–æ, —Ä—É–± —Å –ù–î–°"]]
            # endregion
            # region –ø–æ–ª—É—á–µ–Ω–∏–µ —á–∏—Å–ª–∞ –∫–æ–Ω–∞–ª–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –§–†–°, –¥–∞—Ç—ã –ø–µ—Ä–µ—Ö–æ–¥–∞ –º–∞–≥–∞–∑–∏–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞
            FINREZ_00 = FINREZ.groupby(["–º–∞–≥–∞–∑–∏–Ω", "–¥–∞—Ç–∞"])['–∫–∞–Ω–∞–ª'].nunique().reset_index()
            FINREZ_00 = FINREZ_00.rename(columns={'–∫–∞–Ω–∞–ª': '–∫–∞–Ω–∞–ª_–∫–æ–ª'})
            FINREZ = pd.merge(FINREZ, FINREZ_00[['–º–∞–≥–∞–∑–∏–Ω', '–¥–∞—Ç–∞', '–∫–∞–Ω–∞–ª_–∫–æ–ª']], on=['–º–∞–≥–∞–∑–∏–Ω', '–¥–∞—Ç–∞'],
                              how='left')
            # –¥–∞—Ç—ã –ø—Ä–µ—Ä–µ—Ö–æ–¥–∞ –Ω–∞ —Ñ—Ä–∞–Ω—à–∏–∑—É –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞
            FINREZ.loc[(FINREZ['–¥–∞—Ç–∞'] == '2022-07-01') & (FINREZ['–º–∞–≥–∞–∑–∏–Ω'] == '–ö–æ–º—Å–æ–º–æ–ª—å—Å–∫–∏–π, 34'), '–∫–∞–Ω–∞–ª_–∫–æ–ª'] = 1
            FINREZ.loc[(FINREZ['–¥–∞—Ç–∞'] == '2022-08-01') & (FINREZ['–º–∞–≥–∞–∑–∏–Ω'] == '–õ-–ö, —É–ª.–õ–µ–Ω–∏–Ω–∞, 50'), '–∫–∞–Ω–∞–ª_–∫–æ–ª'] = 1
            FINREZ.loc[(FINREZ['–¥–∞—Ç–∞'] == '2022-07-01') & (FINREZ['–º–∞–≥–∞–∑–∏–Ω'] == '–õ–µ–Ω–∏–Ω–∞, 133'), '–∫–∞–Ω–∞–ª_–∫–æ–ª'] = 1
            FINREZ.loc[(FINREZ['–¥–∞—Ç–∞'] == '2022-07-01') & (FINREZ['–º–∞–≥–∞–∑–∏–Ω'] == '–õ–µ–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫–∏–π, 30/1'), '–∫–∞–Ω–∞–ª_–∫–æ–ª'] = 1
            FINREZ.loc[(FINREZ['–¥–∞—Ç–∞'] == '2022-05-01') & (FINREZ['–º–∞–≥–∞–∑–∏–Ω'] == '–õ–µ–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫–∏–π, 45'), '–∫–∞–Ω–∞–ª_–∫–æ–ª'] = 1
            FINREZ.loc[
                (FINREZ['–¥–∞—Ç–∞'] == '2022-06-01') & (FINREZ['–º–∞–≥–∞–∑–∏–Ω'] == '–ú–µ–∂–¥-–∫, –ø—Ä.–®–∞—Ö—Ç–µ—Ä–æ–≤, 23–ê'), '–∫–∞–Ω–∞–ª_–∫–æ–ª'] = 1
            FINREZ.loc[(FINREZ['–¥–∞—Ç–∞'] == '2022-02-01') & (FINREZ['–º–∞–≥–∞–∑–∏–Ω'] == '–ú–æ—Å–∫–æ–≤—Å–∫–∏–π, 18'), '–∫–∞–Ω–∞–ª_–∫–æ–ª'] = 1
            FINREZ.loc[
                (FINREZ['–¥–∞—Ç–∞'] == '2022-01-01') & (FINREZ['–º–∞–≥–∞–∑–∏–Ω'] == '–ù–æ–≤–æ—Å–∏–±, —É–ª.–ö–∞–º–µ–Ω—Å–∫–∞—è, 44'), '–∫–∞–Ω–∞–ª_–∫–æ–ª'] = 1
            FINREZ.loc[(FINREZ['–¥–∞—Ç–∞'] == '2022-05-01') & (FINREZ['–º–∞–≥–∞–∑–∏–Ω'] == '–ù–æ–≥—Ä–∞–¥—Å–∫–∞—è, 34'), '–∫–∞–Ω–∞–ª_–∫–æ–ª'] = 1
            FINREZ.loc[(FINREZ['–¥–∞—Ç–∞'] == '2022-02-01') & (FINREZ['–º–∞–≥–∞–∑–∏–Ω'] == '–û–∫—Ç—è–±—Ä—å—Å–∫–∏–π, 78'), '–∫–∞–Ω–∞–ª_–∫–æ–ª'] = 1
            FINREZ.loc[
                (FINREZ['–¥–∞—Ç–∞'] == '2022-08-01') & (FINREZ['–º–∞–≥–∞–∑–∏–Ω'] == '–û—Å–∏–Ω–Ω–∏–∫–∏, –ü–æ–±–µ–¥—ã, 32'), '–∫–∞–Ω–∞–ª_–∫–æ–ª'] = 1
            FINREZ.loc[
                (FINREZ['–¥–∞—Ç–∞'] == '2022-07-01') & (FINREZ['–º–∞–≥–∞–∑–∏–Ω'] == '–ü–æ–ª—ã—Å–∞–µ–≤–æ, –ö–æ—Å–º–æ–Ω–∞–≤—Ç–æ–≤ 82'), '–∫–∞–Ω–∞–ª_–∫–æ–ª'] = 1
            FINREZ.loc[
                (FINREZ['–¥–∞—Ç–∞'] == '2022-07-01') & (FINREZ['–º–∞–≥–∞–∑–∏–Ω'] == '–ü—Ä–æ–∫–æ–ø—å–µ–≤—Å–∫, –ì–∞–≥–∞—Ä–∏–Ω–∞, 37'), '–∫–∞–Ω–∞–ª_–∫–æ–ª'] = 1
            FINREZ.loc[(FINREZ['–¥–∞—Ç–∞'] == '2022-08-01') & (FINREZ['–º–∞–≥–∞–∑–∏–Ω'] == '–¢–µ—Ä–µ—à–∫–æ–≤–æ–π, 22–ê'), '–∫–∞–Ω–∞–ª_–∫–æ–ª'] = 1
            FINREZ.loc[(FINREZ['–¥–∞—Ç–∞'] == '2022-05-01') & (FINREZ['–º–∞–≥–∞–∑–∏–Ω'] == '–®–∞—Ö—Ç–µ—Ä–æ–≤, 111'), '–∫–∞–Ω–∞–ª_–∫–æ–ª'] = 1
            FINREZ.loc[(FINREZ['–¥–∞—Ç–∞'] == '2022-06-01') & (FINREZ['–º–∞–≥–∞–∑–∏–Ω'] == '–®–∞—Ö—Ç–µ—Ä–æ–≤, 36'), '–∫–∞–Ω–∞–ª_–∫–æ–ª'] = 1

            # endregion
            # region –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –¥–æ–ª–∏

            r = ("–î–æ–ª—è –ö–∞–ª–∏–Ω–∞ –º–∞–ª–∏–Ω–∞", "–î–æ–ª—è –ü–µ–∫–∞—Ä–Ω—è", "–î–æ–ª—è –ü—Ä–æ–¥—É–∫—Ü–∏—è –∫—É–ª–∏–Ω–∞—Ä–Ω–æ–≥–æ —Ü–µ—Ö–∞ –ö–•–í", "–î–æ–ª—è –†—ã–±–Ω—ã–µ –ø/—Ñ",
                 "–î–æ–ª—è \"–ò–∑–≥–æ—Ç–æ–≤–ª–µ–Ω–æ –ø–æ –∑–∞–∫–∞–∑—É\"",
                 "–î–æ–ª—è –í–æ–ª–∫–æ–≤ –ö–æ—Ñ–µ", "–î–æ–ª—è –∑–µ–ª–µ–Ω—ã–π –º–∞–≥–∞–∑–∏–Ω", "–î–æ–ª—è —Å–æ–ø—É—Ç–∫–∞", "–î–æ–ª—è —Å—É–±–ø—Ä–æ–¥—É–∫—Ç—ã –∫—É—Ä", "–î–æ–ª—è –∫—É—Ä–∏–Ω—ã–µ –ø/—Ñ",
                 "–î–æ–ª—è  –ö–æ—Å—Ç–∏ –ª–∏–≤–µ—Ä –æ—Ç—Ä—É–±–∞", "–î–æ–ª—è  –≥—Ä–∏–ª—å", "–î–æ–ª—è –ø/—Ñ", "–î–æ–ª—è –∫–æ–ª–±–∞—Å–∞")
            for Y in tqdm(r, desc="     –†–∞—Å—á–µ—Ç", ncols=120, colour="#F8C9CE", ):
                FINREZ[Y] = FINREZ[Y] * FINREZ["–í—ã—Ä—É—á–∫–∞ –ò—Ç–æ–≥–æ, —Ä—É–± —Å –ù–î–°"]

            # endregion
            # region –Ω–∞—Ü–µ–Ω–∫–∏

            FINREZ["–ó–∞–∫—É–ø —Ç–æ–≤–∞—Ä–∞ –æ–±—â–∏–π, —Ä—É–± —Å –ù–î–°"] = FINREZ["1.1.–ó–∞–∫—É–ø —Ç–æ–≤–∞—Ä–∞ (–ú–ö–ü –∏ –ö–ü), —Ä—É–± —Å –ù–î–°"] + FINREZ[
                "1.2.–ó–∞–∫—É–ø —Ç–æ–≤–∞—Ä–∞ (—Å–æ–ø—É—Ç–∫–∞), —Ä—É–± —Å –ù–î–°"]
            FINREZ.loc[FINREZ["—Ä–µ–∂–∏–º –Ω–∞–ª–æ–≥–æ–æ–±–ª–æ–∂–µ–Ω–∏—è"] == "—É–ø—Ä–æ—â–µ–Ω–∫–∞", "–ó–∞–∫—É–ø(—Ä–µ–∂–º –Ω–∞–ª–æ–≥–∞)"] = FINREZ[
                "–ó–∞–∫—É–ø —Ç–æ–≤–∞—Ä–∞ –æ–±—â–∏–π, —Ä—É–± —Å –ù–î–°"]
            FINREZ.loc[FINREZ["—Ä–µ–∂–∏–º –Ω–∞–ª–æ–≥–æ–æ–±–ª–æ–∂–µ–Ω–∏—è"] == "–æ–±—â–∏–π", "–ó–∞–∫—É–ø(—Ä–µ–∂–º –Ω–∞–ª–æ–≥–∞)"] = FINREZ[
                "* –ó–∞–∫—É–ø —Ç–æ–≤–∞—Ä–∞ (–ú–ö–ü, –ö–ü, —Å–æ–ø—É—Ç–∫–∞), —Ä—É–± –±–µ–∑ –ù–î–°"]
            FINREZ.loc[FINREZ["–∫–∞–Ω–∞–ª"] == "–ò—Ç–æ–≥–æ –§—Ä–∞–Ω—à–∏–∑–∞", "–ó–∞–∫—É–ø(—Ä–µ–∂–º –Ω–∞–ª–æ–≥–∞)"] = FINREZ["–ù–∞—Ü–µ–Ω–∫–∞ –û–±—â–∞—è, %"]
            FINREZ.loc[FINREZ["–∫–∞–Ω–∞–ª"] == "–ò—Ç–æ–≥–æ –§–†–°", "–ó–∞–∫—É–ø(—Ä–µ–∂–º –Ω–∞–ª–æ–≥–∞)"] = FINREZ["–ù–∞—Ü–µ–Ω–∫–∞ –û–±—â–∞—è, %"]
            FINREZ["–¢–æ–≤–∞—Ä–æ–æ–±–æ—Ä–æ—Ç –ö–ü + –ú–ö–ü, —Ä—É–± —Å –ù–î–°"] = FINREZ["–¢–æ–≤–∞—Ä–æ–æ–±–æ—Ä–æ—Ç (–ø—Ä–æ–¥–∞–∂–∏) –ö–ü, —Ä—É–± —Å –ù–î–°"] + FINREZ[
                "–¢–æ–≤–∞—Ä–æ–æ–±–æ—Ä–æ—Ç (–ø—Ä–æ–¥–∞–∂–∏) –ú–ö–ü, —Ä—É–± —Å –ù–î–°"]
            FINREZ["–¢–æ–≤–∞—Ä–æ–æ–±–æ—Ä–æ—Ç(–û–±—â–∏–π) —Å –ù–î–°"] = FINREZ["–¢–æ–≤–∞—Ä–æ–æ–±–æ—Ä–æ—Ç (–ø—Ä–æ–¥–∞–∂–∏) –ö–ü, —Ä—É–± —Å –ù–î–°"] + FINREZ[
                "–¢–æ–≤–∞—Ä–æ–æ–±–æ—Ä–æ—Ç (–ø—Ä–æ–¥–∞–∂–∏) –ú–ö–ü, —Ä—É–± —Å –ù–î–°"] + FINREZ["–¢–æ–≤–∞—Ä–æ–æ–±–æ—Ä–æ—Ç (–ø—Ä–æ–¥–∞–∂–∏) —Å–æ–ø—É—Ç–∫–∞, —Ä—É–± —Å –ù–î–°"]
            FINREZ["–ù–∞—Ü–µ–Ω–∫–∞ (–û–±—â–∏–π) —Å –ù–î–°"] = FINREZ["–ù–∞—Ü–µ–Ω–∫–∞ –ú–ö–ü –∏ –ö–ü, —Ä—É–± —Å –ù–î–°"] + FINREZ[
                "–ù–∞—Ü–µ–Ω–∫–∞ —Å–æ–ø—É—Ç–∫–∞, —Ä—É–± —Å –ù–î–°"]

            # endregion
            # –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –æ–±–æ–±—â–µ–Ω–∏—è
            FINREZ.loc[FINREZ['–º–∞–≥–∞–∑–∏–Ω'] == "–û—Ñ–∏—Å", "–∫–∞–Ω–∞–ª"] = "–û—Ñ–∏—Å"
            FINREZ.loc[FINREZ['–º–∞–≥–∞–∑–∏–Ω'] == "–†–æ—è–ª—Ç–∏ –§–†–°", "–∫–∞–Ω–∞–ª"] = "–†–æ—è–ª—Ç–∏ –§–†–°"
            FINREZ = FINREZ.reset_index(drop=True)
            # —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ —Å –∫–∞–Ω–∞–ª–∞–º–∏ –∏ —Ä–µ–∂–∏–º–æ–º –Ω–∞–ª–æ–≥–æ–±–ª–æ–∂–µ–Ω–∏—è
            FINREZ_MAX = FINREZ[
                ["–¥–∞—Ç–∞", '–º–∞–≥–∞–∑–∏–Ω', '—Ä–µ–∂–∏–º –Ω–∞–ª–æ–≥–æ–æ–±–ª–æ–∂–µ–Ω–∏—è', '–∫–∞–Ω–∞–ª', '–∫–∞–Ω–∞–ª –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –∑–∞–∫—Ä—ã—Ç—ã–π –ø–µ—Ä–∏–æ–¥']]
            DOC().to_TEMP(x=FINREZ_MAX, name="–î–∞—Ç–∞_–∫–∞–Ω–∞–ª_–Ω–∞–ª–æ–≥.csv")
            print("–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ - –î–∞—Ç–∞_–∫–∞–Ω–∞–ª_–Ω–∞–ª–æ–≥.csv")
            # –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–∫—É–ø —Ç–æ–≤–∞—Ä–∞ —Å –ù–î–°
            FINREZ["–ó–∞–∫—É–ø —Ç–æ–≤–∞—Ä–∞ –æ–±—â–∏–π, —Ä—É–± —Å –ù–î–°"] = FINREZ["1.1.–ó–∞–∫—É–ø —Ç–æ–≤–∞—Ä–∞ (–ú–ö–ü –∏ –ö–ü), —Ä—É–± —Å –ù–î–°"] + \
                                                      FINREZ["1.2.–ó–∞–∫—É–ø —Ç–æ–≤–∞—Ä–∞ (—Å–æ–ø—É—Ç–∫–∞), —Ä—É–± —Å –ù–î–°"]
            FINREZ.loc[(FINREZ["–∫–∞–Ω–∞–ª"] == "–§–†–°") & (FINREZ["—Ä–µ–∂–∏–º –Ω–∞–ª–æ–≥–æ–æ–±–ª–æ–∂–µ–Ω–∏—è"] == "—É–ø—Ä–æ—â–µ–Ω–∫–∞"),
            "* –ó–∞–∫—É–ø —Ç–æ–≤–∞—Ä–∞ (–ú–ö–ü, –ö–ü, —Å–æ–ø—É—Ç–∫–∞), —Ä—É–± –±–µ–∑ –ù–î–°"] = FINREZ["–ó–∞–∫—É–ø —Ç–æ–≤–∞—Ä–∞ –æ–±—â–∏–π, —Ä—É–± —Å –ù–î–°"]
            # —Ä–∞–∑–≤–æ—Ä–æ—Ç —Ç–∞–±–ª–∏—Ü—ã —Ñ–Ω—Ä–µ–∑–∞
            FINREZ = FINREZ.melt(
                id_vars=["–¥–∞—Ç–∞", "–º–∞–≥–∞–∑–∏–Ω", "—Ä–µ–∂–∏–º –Ω–∞–ª–æ–≥–æ–æ–±–ª–æ–∂–µ–Ω–∏—è", "–∫–∞–Ω–∞–ª", "–∫–∞–Ω–∞–ª –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –∑–∞–∫—Ä—ã—Ç—ã–π –ø–µ—Ä–∏–æ–¥",
                         '–∫–∞–Ω–∞–ª_–∫–æ–ª'],
                var_name="—Å—Ç–∞—Ç—å—è",
                value_name="–∑–Ω–∞—á–µ–Ω–∏–µ")
            # –æ—á–∏—Å—Ç–∫–∞ –æ—Ç –º—É—Å–æ—Ä–∞
            FINREZ['–∑–Ω–∞—á–µ–Ω–∏–µ'] = FINREZ['–∑–Ω–∞—á–µ–Ω–∏–µ'].astype("str")
            FINREZ['–∑–Ω–∞—á–µ–Ω–∏–µ'] = FINREZ['–∑–Ω–∞—á–µ–Ω–∏–µ'].str.replace(u'\xa0', "")
            FINREZ['–∑–Ω–∞—á–µ–Ω–∏–µ'] = np.where((FINREZ['–∑–Ω–∞—á–µ–Ω–∏–µ'] == 0), "nan", FINREZ['–∑–Ω–∞—á–µ–Ω–∏–µ'])
            FINREZ['–∑–Ω–∞—á–µ–Ω–∏–µ'] = np.where((FINREZ['–∑–Ω–∞—á–µ–Ω–∏–µ'] == "-"), "nan", FINREZ['–∑–Ω–∞—á–µ–Ω–∏–µ'])
            FINREZ['–∑–Ω–∞—á–µ–Ω–∏–µ'] = np.where((FINREZ['–∑–Ω–∞—á–µ–Ω–∏–µ'] == "#–î–ï–õ/0!"), "nan", FINREZ['–∑–Ω–∞—á–µ–Ω–∏–µ'])
            FINREZ['–∑–Ω–∞—á–µ–Ω–∏–µ'] = np.where((FINREZ['–∑–Ω–∞—á–µ–Ω–∏–µ'] == "#–ó–ù–ê–ß!"), "nan", FINREZ['–∑–Ω–∞—á–µ–Ω–∏–µ'])
            FINREZ['–∑–Ω–∞—á–µ–Ω–∏–µ'] = FINREZ['–∑–Ω–∞—á–µ–Ω–∏–µ'].str.replace(",", ".")
            FINREZ = FINREZ.loc[(FINREZ['–∑–Ω–∞—á–µ–Ω–∏–µ'] != "nan")]

            FINREZ['–∑–Ω–∞—á–µ–Ω–∏–µ'] = FINREZ['–∑–Ω–∞—á–µ–Ω–∏–µ'].astype("float")
            FINREZ = FINREZ.loc[(FINREZ['–∑–Ω–∞—á–µ–Ω–∏–µ'] != 0)]
            # –æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ
            FINREZ['–∑–Ω–∞—á–µ–Ω–∏–µ'] = FINREZ['–∑–Ω–∞—á–µ–Ω–∏–µ'].round(2)
            # –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è –∑–∞–∫—É–ø–∞
            FINREZ.loc[FINREZ[
                           "—Å—Ç–∞—Ç—å—è"] == "* –ó–∞–∫—É–ø —Ç–æ–≤–∞—Ä–∞ (–ú–ö–ü, –ö–ü, —Å–æ–ø—É—Ç–∫–∞), —Ä—É–± –±–µ–∑ –ù–î–°", "—Å—Ç–∞—Ç—å—è"] = "–ó–∞–∫—É–ø —Ç–æ–≤–∞—Ä–∞ (–ú–ö–ü, –ö–ü, —Å–æ–ø—É—Ç–∫–∞), —Ä—É–± –±–µ–∑ –ù–î–°"
            # region –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ —Å–∞—Ç–µ–π
            STATYA = NEW().STATYA()
            FINREZ = FINREZ.merge(STATYA[["—Å—Ç–∞—Ç—å—è", "—Ñ—Ä—Å_—Ä–∞—Å—á–µ—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ",
                                          "—Ñ—Ä_—Ä–∞—Å—á–µ—Ç —á–∏—Å—Ç–æ–π –ø—Ä–∏–±—ã–ª–∏", "–ø–æ–¥–≥—Ä—É–ø–ø–∞", "–≥—Ä—É–ø–ø–∞",
                                          "—Ñ—Ä—Å_—Ä–∞—Å—á–µ—Ç —á–∏—Å—Ç–æ–π –ø—Ä–∏–±—ã–ª–∏", "—É–¥–∞–ª–∏—Ç—å –¥–ª—è —Ñ—Ä—Å –∏ –∞—Ä–µ–Ω–¥–∞", "–æ—Ç–±–æ—Ä"]],
                                  on=["—Å—Ç–∞—Ç—å—è"], how="left")
            # endregion

            # region —É–±—Ä–∞—Ç—å –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è —Å–æ—á–µ—Ç–∞–Ω–∏—è —Ñ—Ä—Å –≥–¥–µ –±–æ–ª–µ–µ 2—Ö –∫–∞–Ω–∞–ª–æ–≤ –≤ –º–µ—Å—è—Ü–µ
            FINREZ_Er = FINREZ.copy()
            mask = (FINREZ['–∫–∞–Ω–∞–ª'] == '–§–†–°') & (FINREZ['–∫–∞–Ω–∞–ª_–∫–æ–ª'] == 2) & (
                        FINREZ["—É–¥–∞–ª–∏—Ç—å –¥–ª—è —Ñ—Ä—Å –∏ –∞—Ä–µ–Ω–¥–∞"] == '–¥–∞')
            FINREZ.loc[mask, '–∑–Ω–∞—á–µ–Ω–∏–µ'] = 0


            # –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–∞ –¥–ª—è –∫–∞—Å–∫–∞–¥–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
            FINREZ["–∫–∞—Å–∫–∞–¥"] = FINREZ["–∑–Ω–∞—á–µ–Ω–∏–µ"]
            FINREZ.loc[FINREZ["–≥—Ä—É–ø–ø–∞"] == "–ó–∞—Ç—Ä–∞—Ç—ã, —Ä—É–±.(–±–µ–∑ –ù–î–°)", "–∫–∞—Å–∫–∞–¥"] = -FINREZ["–∑–Ω–∞—á–µ–Ω–∏–µ"]
            FINREZ.loc[FINREZ["–≥—Ä—É–ø–ø–∞"] == "–ó–∞–∫—É–ø, —Ä—É–±.(–±–µ–∑ –ù–î–°)", "–∫–∞—Å–∫–∞–¥"] = -FINREZ["–∑–Ω–∞—á–µ–Ω–∏–µ"]

            DOC().to_POWER_BI(x=FINREZ, name="–§–∏–Ω—Ä–µ–∑_–§–†–°–¢–ï–°–¢.csv")
            print(FINREZ)
            # –¥–µ–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü –Ω–∞ –∫–∞–Ω–∞–ª—ã
            # ################################################################# –§–†–°
            # –§–†–° —Ç–æ–ª—å–∫–æ —Å—Ç–∞—Ç—å —É—á–∞—Å—Ç–≤—É—é—â–∏–µ –≤ —á–∏—Å—Ç–æ–π –ø—Ä–∏–±—ã–ª–∏
            FINREZ_FRS = FINREZ.loc[FINREZ["–∫–∞–Ω–∞–ª"] == "–§–†–°"]
            FINREZ_FRS = FINREZ_FRS.loc[(FINREZ_FRS["—Ñ—Ä—Å_—Ä–∞—Å—á–µ—Ç —á–∏—Å—Ç–æ–π –ø—Ä–∏–±—ã–ª–∏"] == "–¥–∞")]

            # –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —á–∏—Å—Ç–æ–π –ø—Ä–∏–±—ã–ª–∏
            grouped = FINREZ_FRS.groupby(
                ['–º–∞–≥–∞–∑–∏–Ω', '–¥–∞—Ç–∞', '–∫–∞–Ω–∞–ª', "–∫–∞–Ω–∞–ª –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –∑–∞–∫—Ä—ã—Ç—ã–π –ø–µ—Ä–∏–æ–¥", "—Ä–µ–∂–∏–º –Ω–∞–ª–æ–≥–æ–æ–±–ª–æ–∂–µ–Ω–∏—è"])

            sums = grouped['–∫–∞—Å–∫–∞–¥'].agg('sum')
            new_row = pd.DataFrame({
                '–º–∞–≥–∞–∑–∏–Ω': sums.index.get_level_values('–º–∞–≥–∞–∑–∏–Ω'),
                '–¥–∞—Ç–∞': sums.index.get_level_values('–¥–∞—Ç–∞'),
                "–∫–∞–Ω–∞–ª –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –∑–∞–∫—Ä—ã—Ç—ã–π –ø–µ—Ä–∏–æ–¥": sums.index.get_level_values("–∫–∞–Ω–∞–ª –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –∑–∞–∫—Ä—ã—Ç—ã–π –ø–µ—Ä–∏–æ–¥"),
                "—Ä–µ–∂–∏–º –Ω–∞–ª–æ–≥–æ–æ–±–ª–æ–∂–µ–Ω–∏—è": sums.index.get_level_values("—Ä–µ–∂–∏–º –Ω–∞–ª–æ–≥–æ–æ–±–ª–æ–∂–µ–Ω–∏—è"),
                '–∫–∞–Ω–∞–ª': sums.index.get_level_values('–∫–∞–Ω–∞–ª'),
                "—Å—Ç–∞—Ç—å—è": '—á–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å',
                '–∑–Ω–∞—á–µ–Ω–∏–µ': sums.values,
                '–∫–∞—Å–∫–∞–¥': sums.values})
            FINREZ_FRS = pd.concat([FINREZ_FRS, new_row], axis=0)
            # region ERROR –§–†–°
            FINREZ_Er = FINREZ_Er.loc[FINREZ_Er["–∫–∞–Ω–∞–ª"] == "–§–†–°"].copy()
            FINREZ_Er.loc[
                FINREZ_Er["—Å—Ç–∞—Ç—å—è"] == "–ü—Ä–∏–±—ã–ª—å (+) / –£–±—ã—Ç–æ–∫ (-) (= –¢- –û–ï), —Ä—É–± –±–µ–∑ –ù–î–°", "—Å—Ç–∞—Ç—å—è"] = "—á–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å"
            FINREZ_ERROR = FINREZ_Er.loc[FINREZ_Er["—Å—Ç–∞—Ç—å—è"] == "—á–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å"].copy()
            FINREZ_ERROR = FINREZ_ERROR.rename(columns={"–∑–Ω–∞—á–µ–Ω–∏–µ": "–∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ –∏—Ç–æ–≥–æ–≤"})

            FINREZ_FRS_00 = FINREZ_FRS.copy()
            FINREZ_FRS_00 = FINREZ_FRS_00.loc[FINREZ_FRS_00["—Å—Ç–∞—Ç—å—è"] == "—á–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å"]
            FINREZ_ERROR_FRS = FINREZ_FRS_00.merge(
                FINREZ_ERROR[["–¥–∞—Ç–∞", "–∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ –∏—Ç–æ–≥–æ–≤", "–º–∞–≥–∞–∑–∏–Ω", "—Å—Ç–∞—Ç—å—è", '–∫–∞–Ω–∞–ª']],
                on=["—Å—Ç–∞—Ç—å—è", "–º–∞–≥–∞–∑–∏–Ω", "–¥–∞—Ç–∞", '–∫–∞–Ω–∞–ª'], how="left")
            FINREZ_ERROR_FRS["—Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ"] = FINREZ_ERROR_FRS["–∑–Ω–∞—á–µ–Ω–∏–µ"] - FINREZ_ERROR_FRS["–∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ –∏—Ç–æ–≥–æ–≤"]
            FINREZ_ERROR_FRS = FINREZ_ERROR_FRS.loc[
                (FINREZ_ERROR_FRS["—Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ"] < -10) | (FINREZ_ERROR_FRS["—Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ"] > 10)]
            # endregion
            # –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–µ–π –¥–ª—è —Ñ—Ä—Å
            FINREZ_FRS_01 = FINREZ.loc[FINREZ["–∫–∞–Ω–∞–ª"] == "–§–†–°"]
            FINREZ_FRS_01 = FINREZ_FRS_01.loc[(FINREZ_FRS_01["–æ—Ç–±–æ—Ä"] == "—Ç–æ–≤–∞—Ä–æ–±–æ—Ä–æ—Ç") |
                                              (FINREZ_FRS_01["–æ—Ç–±–æ—Ä"] == "–Ω–∞—Ü–µ–Ω–∫–∞") |
                                              (FINREZ_FRS_01["–æ—Ç–±–æ—Ä"] == "–¥–æ–ª—è") |
                                              (FINREZ_FRS_01["–æ—Ç–±–æ—Ä"] == "–∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏") |
                                              (FINREZ_FRS_01["–æ—Ç–±–æ—Ä"] == "—Ç–æ—á–∫–∞ –±–µ–∑—É–±—ã—Ç–æ—á–Ω–æ—Å—Ç–∏") |
                                              (FINREZ_FRS_01["–æ—Ç–±–æ—Ä"] == "–ø–µ—Ä—Å–æ–Ω–∞–ª")]
            FINREZ_FRS = pd.concat([FINREZ_FRS, FINREZ_FRS_01], axis=0)
            # –§—Ä—Å –∏—Å–∫–ª—é—á–µ–Ω–∏—è –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏
            FINREZ_FRS.loc[(FINREZ_FRS["–æ—Ç–±–æ—Ä"] == "—Ç–æ–≤–∞—Ä–æ–±–æ—Ä–æ—Ç") |
                           (FINREZ_FRS["–æ—Ç–±–æ—Ä"] == "–Ω–∞—Ü–µ–Ω–∫–∞") |
                           (FINREZ_FRS["–æ—Ç–±–æ—Ä"] == "–¥–æ–ª—è") |
                           (FINREZ_FRS["–æ—Ç–±–æ—Ä"] == "–∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏") |
                           (FINREZ_FRS["–æ—Ç–±–æ—Ä"] == "—Ç–æ—á–∫–∞ –±–µ–∑—É–±—ã—Ç–æ—á–Ω–æ—Å—Ç–∏") |
                           (FINREZ_FRS["–æ—Ç–±–æ—Ä"] == "–ø–µ—Ä—Å–æ–Ω–∞–ª"), "–∫–∞—Å–∫–∞–¥"] = 0

            FINREZ_FRS = FINREZ_FRS.reset_index(drop=True)

            # ################################################################# –§–†–ê–ù–®–ò–ó–ê
            # –§–†–ê–ù–®–ò–ó–ê —Ç–æ–ª—å–∫–æ —Å—Ç–∞—Ç—å —É—á–∞—Å—Ç–≤—É—é—â–∏–µ –≤ —á–∏—Å—Ç–æ–π –ø—Ä–∏–±—ã–ª–∏
            FINREZ_FRANSHIZA = FINREZ.loc[
                (FINREZ["–∫–∞–Ω–∞–ª"] == "–§—Ä–∞–Ω—à–∏–∑–∞ –≤ –∞—Ä–µ–Ω–¥—É") | (FINREZ["–∫–∞–Ω–∞–ª"] == "–§—Ä–∞–Ω—à–∏–∑–∞ –≤–Ω–µ—à–Ω—è—è")]
            FINREZ_FRANSHIZA = FINREZ_FRANSHIZA.loc[(FINREZ_FRANSHIZA["—Ñ—Ä_—Ä–∞—Å—á–µ—Ç —á–∏—Å—Ç–æ–π –ø—Ä–∏–±—ã–ª–∏"] == "–¥–∞")]

            # –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —á–∏—Å—Ç–æ–π –ø—Ä–∏–±—ã–ª–∏
            grouped = FINREZ_FRANSHIZA.groupby(
                ['–º–∞–≥–∞–∑–∏–Ω', '–¥–∞—Ç–∞', '–∫–∞–Ω–∞–ª', "–∫–∞–Ω–∞–ª –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –∑–∞–∫—Ä—ã—Ç—ã–π –ø–µ—Ä–∏–æ–¥", "—Ä–µ–∂–∏–º –Ω–∞–ª–æ–≥–æ–æ–±–ª–æ–∂–µ–Ω–∏—è"])
            sums = grouped['–∫–∞—Å–∫–∞–¥'].agg('sum')
            new_row = pd.DataFrame({
                '–º–∞–≥–∞–∑–∏–Ω': sums.index.get_level_values('–º–∞–≥–∞–∑–∏–Ω'),
                '–¥–∞—Ç–∞': sums.index.get_level_values('–¥–∞—Ç–∞'),
                "–∫–∞–Ω–∞–ª –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –∑–∞–∫—Ä—ã—Ç—ã–π –ø–µ—Ä–∏–æ–¥": sums.index.get_level_values("–∫–∞–Ω–∞–ª –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –∑–∞–∫—Ä—ã—Ç—ã–π –ø–µ—Ä–∏–æ–¥"),
                "—Ä–µ–∂–∏–º –Ω–∞–ª–æ–≥–æ–æ–±–ª–æ–∂–µ–Ω–∏—è": sums.index.get_level_values("—Ä–µ–∂–∏–º –Ω–∞–ª–æ–≥–æ–æ–±–ª–æ–∂–µ–Ω–∏—è"),
                '–∫–∞–Ω–∞–ª': sums.index.get_level_values('–∫–∞–Ω–∞–ª'),
                "—Å—Ç–∞—Ç—å—è": '—á–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å',
                '–∑–Ω–∞—á–µ–Ω–∏–µ': sums.values,
                '–∫–∞—Å–∫–∞–¥': sums.values})
            FINREZ_FRANSHIZA = pd.concat([FINREZ_FRANSHIZA, new_row], axis=0)
            # region ERROR –§–†
            FINREZ_00 = FINREZ.copy()
            FINREZ_00.loc[
                FINREZ_00["—Å—Ç–∞—Ç—å—è"] == "–ü—Ä–∏–±—ã–ª—å (+) / –£–±—ã—Ç–æ–∫ (-) (= –¢- –û–ï), —Ä—É–± –±–µ–∑ –ù–î–°", "—Å—Ç–∞—Ç—å—è"] = '—á–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å'
            FINREZ_ERROR = FINREZ_00.loc[FINREZ_00["—Å—Ç–∞—Ç—å—è"] == '—á–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å'].copy()
            FINREZ_ERROR = FINREZ_ERROR.rename(columns={"–∑–Ω–∞—á–µ–Ω–∏–µ": "–∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ –∏—Ç–æ–≥–æ–≤"})
            FINREZ_FRANSHIZA_00 = FINREZ_FRANSHIZA.copy()
            FINREZ_FRANSHIZA_00 = FINREZ_FRANSHIZA_00.loc[FINREZ_FRANSHIZA_00["—Å—Ç–∞—Ç—å—è"] == "—á–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å"]

            FINREZ_ERROR_FR = FINREZ_FRANSHIZA_00.merge(
                FINREZ_ERROR[["–¥–∞—Ç–∞", "–∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ –∏—Ç–æ–≥–æ–≤", "–º–∞–≥–∞–∑–∏–Ω", "—Å—Ç–∞—Ç—å—è", '–∫–∞–Ω–∞–ª']],
                on=["—Å—Ç–∞—Ç—å—è", "–º–∞–≥–∞–∑–∏–Ω", "–¥–∞—Ç–∞", '–∫–∞–Ω–∞–ª'], how="left")
            FINREZ_ERROR_FR["—Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ"] = FINREZ_ERROR_FR["–∑–Ω–∞—á–µ–Ω–∏–µ"] - FINREZ_ERROR_FR["–∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ –∏—Ç–æ–≥–æ–≤"]
            FINREZ_ERROR_FR = FINREZ_ERROR_FR.loc[
                (FINREZ_ERROR_FR["—Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ"] < -10) | (FINREZ_ERROR_FR["—Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ"] > 10)]
            # endregion
            # –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤—ã—Ä—É—á–∫–∏ –±–µ–∑ –Ω–¥—Å –¥–ª—è —Ñ—Ä–∞–Ω—à–∏–∑—ã
            FINREZ_FRANSHIZA_01 = FINREZ.loc[
                (FINREZ["–∫–∞–Ω–∞–ª"] == "–§—Ä–∞–Ω—à–∏–∑–∞ –≤ –∞—Ä–µ–Ω–¥—É") | (FINREZ["–∫–∞–Ω–∞–ª"] == "–§—Ä–∞–Ω—à–∏–∑–∞ –≤–Ω–µ—à–Ω—è—è")]
            FINREZ_FRANSHIZA_01 = FINREZ_FRANSHIZA_01.loc[
                (FINREZ_FRANSHIZA_01["—Å—Ç–∞—Ç—å—è"] == "–í—ã—Ä—É—á–∫–∞ –ò—Ç–æ–≥–æ, —Ä—É–± –±–µ–∑ –ù–î–°")]

            FINREZ_FRANSHIZA_01.loc[FINREZ_FRANSHIZA_01[
                                        "—Å—Ç–∞—Ç—å—è"] == "–í—ã—Ä—É—á–∫–∞ –ò—Ç–æ–≥–æ, —Ä—É–± –±–µ–∑ –ù–î–°", "—Å—Ç–∞—Ç—å—è"] = '–í—ã—Ä—É—á–∫–∞ –ò—Ç–æ–≥–æ, —Ä—É–± –±–µ–∑ –ù–î–°(–¥–ª—è —Ñ—Ä–∞–Ω—à–∏–∑—ã)'
            FINREZ_FRANSHIZA = pd.concat([FINREZ_FRANSHIZA, FINREZ_FRANSHIZA_01], axis=0)
            FINREZ_FRANSHIZA = FINREZ_FRANSHIZA.reset_index(drop=True)

            # –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –¢–æ–≤–∞—Ä–æ–æ–±–æ—Ä–æ—Ç–∞ –±–µ–∑ –Ω–¥—Å –¥–ª—è —Ñ—Ä–∞–Ω—à–∏–∑—ã
            FINREZ_FRANSHIZA_01 = FINREZ.loc[
                (FINREZ["–∫–∞–Ω–∞–ª"] == "–§—Ä–∞–Ω—à–∏–∑–∞ –≤ –∞—Ä–µ–Ω–¥—É") | (FINREZ["–∫–∞–Ω–∞–ª"] == "–§—Ä–∞–Ω—à–∏–∑–∞ –≤–Ω–µ—à–Ω—è—è")]
            FINREZ_FRANSHIZA_01 = FINREZ_FRANSHIZA_01.loc[(FINREZ_FRANSHIZA_01["–æ—Ç–±–æ—Ä"] == "—Ç–æ–≤–∞—Ä–æ–±–æ—Ä–æ—Ç") |
                                                          (FINREZ_FRANSHIZA_01["–æ—Ç–±–æ—Ä"] == "–Ω–∞—Ü–µ–Ω–∫–∞") |
                                                          (FINREZ_FRANSHIZA_01["–æ—Ç–±–æ—Ä"] == "–¥–æ–ª—è") |
                                                          (FINREZ_FRS_01["–æ—Ç–±–æ—Ä"] == "–∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏")]
            FINREZ_FRANSHIZA = pd.concat([FINREZ_FRANSHIZA, FINREZ_FRANSHIZA_01], axis=0)
            # –§—Ä—Å –∏—Å–∫–ª—é—á–µ–Ω–∏—è –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏
            FINREZ_FRANSHIZA.loc[(FINREZ_FRANSHIZA["–æ—Ç–±–æ—Ä"] == "—Ç–æ–≤–∞—Ä–æ–±–æ—Ä–æ—Ç") |
                           (FINREZ_FRANSHIZA["–æ—Ç–±–æ—Ä"] == "–Ω–∞—Ü–µ–Ω–∫–∞") |
                           (FINREZ_FRANSHIZA["–æ—Ç–±–æ—Ä"] == "–¥–æ–ª—è") |
                           (FINREZ_FRANSHIZA["–æ—Ç–±–æ—Ä"] == "–∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏") |
                           (FINREZ_FRANSHIZA["–æ—Ç–±–æ—Ä"] == "—Ç–æ—á–∫–∞ –±–µ–∑—É–±—ã—Ç–æ—á–Ω–æ—Å—Ç–∏") |
                           (FINREZ_FRANSHIZA["–æ—Ç–±–æ—Ä"] == "–ø–µ—Ä—Å–æ–Ω–∞–ª"), "–∫–∞—Å–∫–∞–¥"] = 0
            FINREZ_FRANSHIZA = FINREZ_FRANSHIZA.reset_index(drop=True)

            # ################################################################# –§–†–ê–ù–®–ò–ó–ê
            FINREZ_FRANSHIZA = FINREZ_FRANSHIZA.rename(columns={'–∑–Ω–∞—á–µ–Ω–∏–µ': '–∑–Ω–∞—á–µ–Ω–∏–µ_—Ñ—Ä', "–∫–∞—Å–∫–∞–¥": "–∫–∞—Å–∫–∞–¥_—Ñ—Ä"})
            FINREZ_FRS = FINREZ_FRS.rename(columns={'–∑–Ω–∞—á–µ–Ω–∏–µ': '–∑–Ω–∞—á–µ–Ω–∏–µ_—Ñ—Ä—Å', "–∫–∞—Å–∫–∞–¥": "–∫–∞—Å–∫–∞–¥_—Ñ—Ä—Å"})
            FINREZ = pd.concat([FINREZ_FRANSHIZA, FINREZ_FRS], axis=0)
            FINREZ = FINREZ.reset_index(drop=True)

            # —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –¥–ª—è –¥–∞–ª—å–Ω–µ—Ü—à–µ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
            DOC().to_ERROR(x=FINREZ_ERROR_FRS,
                           name="–û—à–∏–∫–∏ –§–†–°(—Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —á–∏—Å—Ç–æ–π –ø—Ä–∏—ã–ª–∏ –∏–∑ —Ñ–∞–π–ª–∞ –∏ –≤—ã—á–µ—Å–ª–µ–Ω–æ–π –ø–æ —Å—Ç–∞—Ç–µ–π–Ω–æ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞.csv")
            DOC().to_ERROR(x=FINREZ_ERROR_FR,
                           name="–û—à–∏–∫–∏ —Ñ—Ä–∞–Ω—à–∏–∑–∞(—Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —á–∏—Å—Ç–æ–π –ø—Ä–∏—ã–ª–∏ –∏–∑ —Ñ–∞–π–ª–∞ –∏ –≤—ã—á–µ—Å–ª–µ–Ω–æ–π –ø–æ —Å—Ç–∞—Ç–µ–π–Ω–æ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞.csv")
            DOC().to_POWER_BI(x=FINREZ_FRANSHIZA, name="–§–∏–Ω—Ä–µ–∑_–§—Ä–∞–Ω—à–∏–∑–∞.csv")
            DOC().to_POWER_BI(x=FINREZ_FRS, name="–§–∏–Ω—Ä–µ–∑_–§–†–°.csv")
            DOC().to_POWER_BI(x=FINREZ, name="–§–∏–Ω—Ä–µ–∑_–û–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π.csv")
            print("–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ - –§–∏–Ω—Ä–µ–∑_–û–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π.csv")
            return FINREZ
    '''–æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∏–Ω—Ä–µ–∑–∞ –∏—Ç–æ–≥–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π'''
    def History(self):
        print("–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏")
        rng, replacements = RENAME().Rread()
        path = "D:\\Python\\Dashboard\\–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ\\"  ##–≥–ª–∞–≤–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥
        path_to = "D:\\Python\\Dashboard\\–ü–£–¢–¨ –î–û –§–ê–ô–õ–û–í –° –ü–†–û–î–ê–ñ–ê–ú–ò\\"   ##–ö—É–¥–∞
        papki_1uroven = os.listdir(path)  ##  —Å–º–æ—Ç—Ä–∏—Ç –ø–∞–ø–∫–∏ –≥–ª–∞–≤–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥
        for god in papki_1uroven:
            os.mkdir(path_to + god)  ##  —Å–æ–∑–¥–∞–µ—Ç  –∫–∞—Ç–∞–ª–æ–≥–∏ –¥–ª—è –≥–æ–¥–∞
            papki_2uroven = os.listdir(path + god)  ##  —Å–º–æ—Ç—Ä–∏—Ç –ø–∞–ø–∫–∏ –≤–Ω—É—Ç—Ä–∏ –≥–æ–¥–∞ –∫–∞—Ç–∞–ª–æ–≥
            for mon in papki_2uroven:  ##  –≤—ã–±–∏—Ä–∞–µ—Ç –º–µ—Å—è—Ü
                os.mkdir(path_to + god + "\\" + mon)  ##  —Å–æ–∑–¥–∞–µ—Ç  –∫–∞—Ç–∞–ª–æ–≥–∏ –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –º–µ—Å—è—Ü–∞
                files = os.listdir(path + god + "\\" + mon)  ## —Å–º–æ—Ç—Ä–∏—Ç —Ñ–∞–π–ª—ã –≤ –≤—ã–±—Ä–∞–Ω–Ω–Ω–æ–º –º–µ—Å—è—Ü–µ
                for f in tqdm(files, desc="–ì–û–î–ê   --  ", ncols=130):  ##  –ø–µ—Ä–µ–±–µ—Ä–∞–µ—Ç —Ñ–∞–π–ª—ã
                    file = path + god + "\\" + mon + "\\" + f
                    stroka = open(file, 'r', encoding='utf-8')
                    new_name = f
                    new_name = new_name[0:23]  ##  –±–µ—Ä–µ—Ç –∏–º—è –¥–ª—è –Ω–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞
                    stroka.close()  ##  –∑–∞–∫—Ä—ã–≤–∞–µ—Ç —Ñ–∞–π–ª
                    df = pd.read_csv(file, sep="\t", encoding='utf-8', parse_dates=['–ü–æ –¥–Ω—è–º'],dayfirst=True,)
                    # —É–¥–∞–ª–µ–Ω–∏–µ –ª–∏—à–Ω–∏—Ö —Å—Ç–æ–ª–±—Ü–æ–≤
                    df = df.drop(["–°–ø–∏—Å–†—É–±"], axis=1)
                    if '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ø–∏—Å–∞–Ω–∏—è' in df.columns:
                       df = df.drop('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ø–∏—Å–∞–Ω–∏—è', axis=1)
                    if '–°–ø–∏—Å–∞–Ω–∏—è, –∫–≥' in df.columns:
                        df = df.drop('–°–ø–∏—Å–∞–Ω–∏—è, –∫–≥', axis=1)
                    # –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–≤
                    for i in tqdm(range(rng), desc="–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ç—Ç –ü—Ä–æ–¥–∞–∂–∏ - ", colour="#808080"): df[
                        '–°–∫–ª–∞–¥ –º–∞–≥–∞–∑–∏–Ω.–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ'] = \
                        df['–°–∫–ª–∞–¥ –º–∞–≥–∞–∑–∏–Ω.–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ'].str.replace(replacements["–ù–ê–ô–¢–ò"][i], replacements["–ó–ê–ú–ï–ù–ò–¢–¨"][i], regex=False)
                    # –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–∞ —Å–ø–∏—Å–∞–Ω–∏—è
                    spis = os.listdir(PUT+ "–°–ø–∏—Å–∞–Ω–∏—è\\"  + god + "\\" + mon)
                    for s in spis:
                        # –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π –≥–æ–¥–∞ –ø–æ –º–∞–∫–µ —Ñ–∞–π–ª–∞ –ø—Ä–æ–¥–∞–∂
                        file_s = PUT+ "–°–ø–∏—Å–∞–Ω–∏—è\\" + god + "\\" + mon + "\\" + s
                        spisisania = pd.read_csv(file_s, sep="\t", encoding='utf-8', skiprows=7, parse_dates=['–ü–æ –¥–Ω—è–º'],dayfirst=True,
                                              names=("–°–∫–ª–∞–¥ –º–∞–≥–∞–∑–∏–Ω.–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ", "–ù–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–∞", '–ü–æ –¥–Ω—è–º', "–æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–ø–∏—Å–∞–Ω–∏—è","–°–ø–∏—Å–†—É–±","—Å–ø–∏—Å—Ä—É–±_–±–µ–∑_–Ω–¥—Å" ))
                        # –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–æ–≤
                        for i in tqdm(range(rng), desc="–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ç—Ç –°–ø–∏—Å–∞–Ω–∏—è - ", colour="#808080"): spisisania[
                            '–°–∫–ª–∞–¥ –º–∞–≥–∞–∑–∏–Ω.–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ'] = \
                            spisisania['–°–∫–ª–∞–¥ –º–∞–≥–∞–∑–∏–Ω.–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ'].str.replace(replacements["–ù–ê–ô–¢–ò"][i], replacements["–ó–ê–ú–ï–ù–ò–¢–¨"][i], regex=False)
                        # –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ñ–∞–π–ª–∞ —Å–ø–∏—Å–∞–Ω–∏—è –º–µ–Ω—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–æ —Ñ–∞–π–ª–∞–º –ø—Ä–æ–¥–∞–∂ –¥—Ç–∞–∞
                        max_sales = df['–ü–æ –¥–Ω—è–º'].max()
                        min_sales = df['–ü–æ –¥–Ω—è–º'].min()
                        spisisania = spisisania.loc[(spisisania['–ü–æ –¥–Ω—è–º'] <= max_sales) & (spisisania['–ü–æ –¥–Ω—è–º'] >= min_sales)]
                        # —É–±—Ä–∞—Ç—å —Å—Ç—Ä–æ–∫—É –∏—Ç–æ–≥–æ
                        spisisania = spisisania.loc[spisisania["–°–∫–ª–∞–¥ –º–∞–≥–∞–∑–∏–Ω.–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ"] != "–ò—Ç–æ–≥–æ"]
                        # —á–∏—Å—Ç–∫–∞ –º—É—Å–æ—Ä–∞ –ø—Ä–æ–¥–∞–∂–∏
                        df["–í—ã—Ä—É—á–∫–∞"] = df["–í—ã—Ä—É—á–∫–∞"].str.replace(',', '.')
                        df["–í—ã—Ä—É—á–∫–∞"] = df["–í—ã—Ä—É—á–∫–∞"].str.replace('\xa0', '')
                        df["–í—ã—Ä—É—á–∫–∞"] = df["–í—ã—Ä—É—á–∫–∞"].astype("float")
                        # —Ç–∞–∫ –∫–∞–∫ —Å—Ç–æ–ª–±–µ—Ü —Å–ø–∏—Å–∞–Ω–∏–π —É–¥–∞–ª–µ–Ω —Ç–æ —É–±—Ä–∞—Ç—å –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏
                        df = df.loc[df["–í—ã—Ä—É—á–∫–∞"] > 0]
                        # —á–∏—Å—Ç–∫–∞ –º—É—Å–æ—Ä–∞ —Å–ø–∏—Å–∞–Ω–∏—è
                        spisisania["–°–ø–∏—Å–†—É–±"] = spisisania["–°–ø–∏—Å–†—É–±"].str.replace(',', '.')
                        spisisania["–°–ø–∏—Å–†—É–±"] = spisisania["–°–ø–∏—Å–†—É–±"].str.replace('\xa0', '')
                        spisisania["–°–ø–∏—Å–†—É–±"] = spisisania["–°–ø–∏—Å–†—É–±"].astype("float")
                        spisisania = spisisania.loc[spisisania["–°–ø–∏—Å–†—É–±"] > 0]
                        # –°–æ–æ–±—â–µ—à–∏–µ –≤ —Ç–µ–ª–µ–≥—Ä–∞–º
                        spisisania_do = spisisania["–°–ø–∏—Å–†—É–±"].copy()
                        df_do = df["–í—ã—Ä—É—á–∫–∞"].copy()

                        # –æ–±—å–µ–¥–µ–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü —Å–ø–∏—Å–∞–Ω–∏—è –∏ –ø—Ä–æ–¥–∞–∂
                        df = pd.concat([df, spisisania], axis=0)

                        # –°–æ–æ–±—â–µ—à–∏–µ –≤ —Ç–µ–ª–µ–≥—Ä–∞–º
                        spisisania_ps = spisisania["–°–ø–∏—Å–†—É–±"].copy()
                        df_ps = df["–í—ã—Ä—É—á–∫–∞"]
                        # –°–æ–æ–±—â–µ—à–∏–µ –≤ —Ç–µ–ª–µ–≥—Ä–∞–º
                        BOT().bot_mes(mes= new_name +"\n–í—ã—Ä—É—á–∫–∞:" + str(df_ps.sum() - df_do.sum())+ "\n–°–ø–∏—Å–∞–Ω–∏—è:" + str(spisisania_ps.sum() - spisisania_do.sum()))

                    df.to_csv(path_to + god + "\\" + mon + "\\" + new_name + ".txt", encoding='utf-8', decimal=",", sep="\t",
                              index=False)  ##  —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ñ–∞–π–ª
                    duration = 1000
                    freq = 220
                    winsound.Beep(freq, duration)
                    # –æ—á–∏—Å—Ç–∫–∞ –ø–∞–º—è—Ç–∏
                    spisisania = pd.DataFrame()
                    df = pd.DataFrame()
                    gc.enable()
                    print(new_name, " –≥–æ—Ç–æ–≤")
                print(mon, ' –≥–æ—Ç–æ–≤')  ##  –ó–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç –º–µ—Å—è—Ü, –ø–∞–ø–∫—É –≤ –≥–æ–¥–µ, –ø–æ—Ç–æ–º –±–µ—Ä–µ —Å–ª–µ–¥.
            print(god, "–≥–æ—Ç–æ–≤")  ##  –ó–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç –≥–æ–¥ , –±–µ—Ä–µ—Ç —Å–ª–µ–¥—É—é—â—É—é
        print("–ì–û–¢–û–í–û")
        return
    """–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ (~2 —á–∞—Å)"""
    def Obnovlenie(self):
        print("–û–ë–ù–û–í–õ–ï–ù–ò–ï –ü–†–û–î–ê–ñ........\n")
        if HISTORY == "y" :
            NEW().History()
        rng, replacements = RENAME().Rread()
        for rootdir, dirs, files in os.walk(PUT + "NEW\\"):
            for file in files:
                if ((file.split('.')[-1]) == 'txt'):
                    pyt_txt = os.path.join(rootdir, file)
                    df = pd.read_csv(pyt_txt, sep="\t", encoding='utf-8', parse_dates=['–ü–æ –¥–Ω—è–º'], dayfirst=True, skiprows=3, names=(
                        ['–°–∫–ª–∞–¥ –º–∞–≥–∞–∑–∏–Ω.–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ', '–ù–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–∞', '–ü–æ –¥–Ω—è–º', '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥–∞–∂', '–í–µ—Å–ü—Ä–æ–¥–∞–∂',
                         '–°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å',
                         '–í—ã—Ä—É—á–∫–∞', '–ü—Ä–∏–±—ã–ª—å', '–°–ø–∏—Å–†—É–±', '–°–ø–∏—Å–∞–Ω–∏—è, –∫–≥']))
                    god  = df['–ü–æ –¥–Ω—è–º'].dt.year.max()
                    # —É–¥–∞–ª–µ–Ω–∏–µ –ª–∏—à–Ω–∏—Ö —Å—Ç–æ–ª–±—Ü–æ–≤
                    df = df.drop(["–°–ø–∏—Å–†—É–±"], axis=1)
                    if '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ø–∏—Å–∞–Ω–∏—è' in df.columns:
                        df = df.drop('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ø–∏—Å–∞–Ω–∏—è', axis=1)
                    if '–°–ø–∏—Å–∞–Ω–∏—è, –∫–≥' in df.columns:
                        df = df.drop('–°–ø–∏—Å–∞–Ω–∏—è, –∫–≥', axis=1)
                    # –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–≤
                    for i in tqdm(range(rng), desc="–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ç—Ç –ü—Ä–æ–¥–∞–∂–∏ - ", colour="#808080"): df[
                        '–°–∫–ª–∞–¥ –º–∞–≥–∞–∑–∏–Ω.–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ'] = \
                        df['–°–∫–ª–∞–¥ –º–∞–≥–∞–∑–∏–Ω.–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ'].str.replace(replacements["–ù–ê–ô–¢–ò"][i], replacements["–ó–ê–ú–ï–ù–ò–¢–¨"][i], regex=False)

                    # –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–∞ —Å–ø–∏—Å–∞–Ω–∏—è
                    # –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π –≥–æ–¥–∞ –ø–æ –º–∞–∫–µ —Ñ–∞–π–ª–∞ –ø—Ä–æ–¥–∞–∂
                    file_s = PUT + "–°–ø–∏—Å–∞–Ω–∏—è\\–¢–µ–∫—É—â–∏–π –º–µ—Å—è—Ü\\"
                    for files in os.listdir(file_s):
                        print(files)
                        spisisania = pd.read_csv(file_s+files, sep="\t", encoding='utf-8', skiprows=7, parse_dates=['–ü–æ –¥–Ω—è–º'], dayfirst=True,
                                                 names=("–°–∫–ª–∞–¥ –º–∞–≥–∞–∑–∏–Ω.–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ", "–ù–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–∞", '–ü–æ –¥–Ω—è–º', "–æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–ø–∏—Å–∞–Ω–∏—è", "–°–ø–∏—Å–†—É–±", "—Å–ø–∏—Å—Ä—É–±_–±–µ–∑_–Ω–¥—Å"))
                        # –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–æ–≤
                        for i in tqdm(range(rng), desc="–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ç—Ç –°–ø–∏—Å–∞–Ω–∏—è - ", colour="#808080"): spisisania[
                            '–°–∫–ª–∞–¥ –º–∞–≥–∞–∑–∏–Ω.–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ'] = \
                            spisisania['–°–∫–ª–∞–¥ –º–∞–≥–∞–∑–∏–Ω.–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ'].str.replace(replacements["–ù–ê–ô–¢–ò"][i], replacements["–ó–ê–ú–ï–ù–ò–¢–¨"][i], regex=False)
                        # –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ñ–∞–π–ª–∞ —Å–ø–∏—Å–∞–Ω–∏—è –º–µ–Ω—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–æ —Ñ–∞–π–ª–∞–º –ø—Ä–æ–¥–∞–∂ –¥a—Ç–∞
                        max_sales = df['–ü–æ –¥–Ω—è–º'].max()
                        min_sales = df['–ü–æ –¥–Ω—è–º'].min()
                        spisisania = spisisania.loc[(spisisania['–ü–æ –¥–Ω—è–º'] <= max_sales) & (spisisania['–ü–æ –¥–Ω—è–º'] >= min_sales)]
                        # —É–±—Ä–∞—Ç—å —Å—Ç—Ä–æ–∫—É –∏—Ç–æ–≥–æ
                        spisisania = spisisania.loc[spisisania["–°–∫–ª–∞–¥ –º–∞–≥–∞–∑–∏–Ω.–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ"] != "–ò—Ç–æ–≥–æ"]
                        # —á–∏—Å—Ç–∫–∞ –º—É—Å–æ—Ä–∞ –ø—Ä–æ–¥–∞–∂–∏
                        df["–í—ã—Ä—É—á–∫–∞"] = df["–í—ã—Ä—É—á–∫–∞"].str.replace(',', '.')
                        df["–í—ã—Ä—É—á–∫–∞"] = df["–í—ã—Ä—É—á–∫–∞"].str.replace('\xa0', '')
                        df["–í—ã—Ä—É—á–∫–∞"] = df["–í—ã—Ä—É—á–∫–∞"].astype("float")
                        # —Ç–∞–∫ –∫–∞–∫ —Å—Ç–æ–ª–±–µ—Ü —Å–ø–∏—Å–∞–Ω–∏–π —É–¥–∞–ª–µ–Ω —Ç–æ —É–±—Ä–∞—Ç—å –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏
                        df = df.loc[df["–í—ã—Ä—É—á–∫–∞"] > 0]
                        # —á–∏—Å—Ç–∫–∞ –º—É—Å–æ—Ä–∞ —Å–ø–∏—Å–∞–Ω–∏—è
                        spisisania["–°–ø–∏—Å–†—É–±"] = spisisania["–°–ø–∏—Å–†—É–±"].str.replace(',', '.')
                        spisisania["–°–ø–∏—Å–†—É–±"] = spisisania["–°–ø–∏—Å–†—É–±"].str.replace('\xa0', '')
                        spisisania["–°–ø–∏—Å–†—É–±"] = spisisania["–°–ø–∏—Å–†—É–±"].astype("float")
                        spisisania = spisisania.loc[spisisania["–°–ø–∏—Å–†—É–±"] > 0]
                        # –î–ª—è —Å–≤–µ—Ä–∫–∏ –∏—Ç–æ–≥–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –ø–æ—Å–ª–µ —Å–ª–∏—è–Ω–∏—è —Å—Ç–æ–ª–±—Ü–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—Ç—ã –¥–æ —Å–ª–∏—è–Ω–∏—è
                        spisisania_do = spisisania["–°–ø–∏—Å–†—É–±"].copy()
                        df_do = df["–í—ã—Ä—É—á–∫–∞"].copy()
                        # –æ–±—å–µ–¥–µ–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü —Å–ø–∏—Å–∞–Ω–∏—è –∏ –ø—Ä–æ–¥–∞–∂
                        df = pd.concat([df, spisisania], axis=0)
                        # –ª–æ–≥
                        max_sales = df['–ü–æ –¥–Ω—è–º'].max()
                        min_sales = df['–ü–æ –¥–Ω—è–º'].min()
                        # –ª–æ–≥ –î–ª—è —Å–≤–µ—Ä–∫–∏ –∏—Ç–æ–≥–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –ø–æ—Å–ª–µ —Å–ª–∏—è–Ω–∏—è —Å—Ç–æ–ª–±—Ü–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—Ç—ã –ø–æ—Å–ª–µ —Å–ª–∏—è–Ω–∏—è
                        spisisania_ps = spisisania["–°–ø–∏—Å–†—É–±"].copy()
                        df_ps = df["–í—ã—Ä—É—á–∫–∞"].copy()
                        # —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–∞
                        df.to_csv(PUT_PROD + file, encoding='utf-8', sep="\t", decimal=",", index=False)  ##  —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ñ–∞–π–ª
                        # –î–õ–Ø –ë–û–¢–ê –¢–ï–õ–ï–ì–†–ê–ú
                        Vrem_dat = datetime.now().strftime('%d.%m.%Y %H:%M')
                        data_str = f"–î–∞—à–±–æ—Ä–¥ –æ–±–Ω–æ–≤–ª–µ–Ω: {Vrem_dat}\n"
                        data_str += "–°—É–º–º–∞ –ø—Ä–æ–¥–∞–∂: {:,.2f}\n".format(df_ps.sum().round(2)).replace(",", " ").replace(".", ",")
                        data_str += "–°—É–º–º–∞ —Å–ø–∏—Å–∞–Ω–∏–π\n(—Å –ø–∏—Ç–∞–Ω–∏–µ–º –∏ —Ö–æ–∑): {:,.2f}\n".format(spisisania_ps.sum().round(2)).replace(",", " ").replace(".", ",")

                        BOT().bot_mes(mes=data_str)
                        if BOT_ANALITIK == "y":
                            BOT().bot_mes_analitik(mes=data_str)

                        bot_t = pd.DataFrame()

                        # –æ—á–∏—Å—Ç–∫–∞ –ø–∞–º—è—Ç–∏
                        spisisania = pd.DataFrame()
                        df = pd.DataFrame()

                if ((file.split('.')[-1]) == 'xlsx'):
                    pyt_excel = os.path.join(rootdir, file)
                    read = pd.read_excel(pyt_excel, sheet_name="Sheet1")
                    for i in tqdm(range(rng), desc="–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ç—Ç —á–µ–∫–∏ -" + file, ncols=120, colour="#F8C9CE", ):
                        read[
                            '–ú–∞–≥–∞–∑–∏–Ω'] = read['–ú–∞–≥–∞–∑–∏–Ω'].replace(replacements["–ù–ê–ô–¢–ò"][i], replacements["–ó–ê–ú–ï–ù–ò–¢–¨"][i],
                                                                 regex=False)
                    read = read.reset_index(drop=True)
                    read.to_excel(PUT_CHEK + file,
                                  index=False)
                gc.collect()
        '''–æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –∑–∞–≥—Ä—É–∑–∫—É –∏ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ–¥–∞–∂ –∏ —á–µ–∫–æ–≤'''
    """–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–µ"""
    def NDS_vir(self):
        rng, replacements = RENAME().Rread()
        print("–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤—ã—Ä—É—á–∫–∏ –Ω–¥—Å\n")
        vir_NDS = pd.DataFrame()
        for rootdir, dirs, files in os.walk(PUT + "–Ω–¥—Å_–≤—ã—Ä—É—á–∫–∞\\"):
            for file in files:
                if ((file.split('.')[-1]) == 'txt'):
                    pyt_txt = os.path.join(rootdir, file)
                    vir_NDS_00 = pd.read_csv(pyt_txt, sep="\t", encoding='utf-8', skiprows=8,
                                             names=("–º–∞–≥–∞–∑–∏–Ω", "–ü–†–û–î–ê–ñ–ò –° –ù–î–°", "–ü–†–û–î–ê–ñ–ò –ë–ï–ó –ù–î–°"))
                    for i in tqdm(range(rng), desc="–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ç—Ç –≤—ã—Ä—É—á–∫–∞ –Ω–¥—Å -" + file, ncols=120,
                                  colour="#F8C9CE"):
                        vir_NDS_00["–º–∞–≥–∞–∑–∏–Ω"] = vir_NDS_00["–º–∞–≥–∞–∑–∏–Ω"].replace(replacements["–ù–ê–ô–¢–ò"][i],
                                                                              replacements["–ó–ê–ú–ï–ù–ò–¢–¨"][i], regex=False)
                    date = file[0:len(file) - 4]
                    vir_NDS_00 = vir_NDS_00.loc[vir_NDS_00["–º–∞–≥–∞–∑–∏–Ω"] != "–ò—Ç–æ–≥–æ"]
                    vir_NDS_00["–¥–∞—Ç–∞"] = date
                    vir_NDS_00["–¥–∞—Ç–∞"] = pd.to_datetime(vir_NDS_00["–¥–∞—Ç–∞"], dayfirst=True)
                    vir_NDS = pd.concat([vir_NDS, vir_NDS_00], axis=0)
        Ren = ["–ü–†–û–î–ê–ñ–ò –° –ù–î–°", "–ü–†–û–î–ê–ñ–ò –ë–ï–ó –ù–î–°"]
        for r in Ren:
            vir_NDS[r] = vir_NDS[r].str.replace(',', '.')
            vir_NDS[r] = vir_NDS[r].str.replace('\xa0', '')
            vir_NDS[r] = vir_NDS[r].astype("float")
        vir_NDS["—Å—Ç–∞–≤–∫–∞ –≤—ã—Ä—É—á–∫–∞ –Ω–¥—Å"] = (vir_NDS["–ü–†–û–î–ê–ñ–ò –ë–ï–ó –ù–î–°"] / vir_NDS["–ü–†–û–î–ê–ñ–ò –° –ù–î–°"])
        vir_NDS["–ü–†–û–í–ï–†–ö–ê–ê"] = vir_NDS["–ü–†–û–î–ê–ñ–ò –° –ù–î–°"] * vir_NDS["—Å—Ç–∞–≤–∫–∞ –≤—ã—Ä—É—á–∫–∞ –Ω–¥—Å"]
        gc.enable()
        return vir_NDS
    '''–æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –∑–∞–≥—Ä—É–∑–∫—É –¥–∞–Ω–Ω—ã—Ö –¥–ª—è  —Ä–∞—Å—á–µ—Ç–∞ —Å—Ç–∞–≤–∫–∏ –≤—ã—Ä—É—á–∫–∏ –Ω–¥—Å'''
    """  def NDS_spisania(self):
        rng, replacements = RENAME().Rread()
        print("–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å–ø–∏—Å–∞–Ω–∏—è –±–µ–∑ —Ö–æ–∑–æ–≤ –Ω–¥—Å\n")
        Spisania = pd.DataFrame()
        for rootdir, dirs, files in os.walk(PUT + "–Ω–¥—Å_—Å–ø–∏—Å–∞–Ω–∏—è_–±–µ–∑_—Ö–æ–∑–æ–≤\\"):
            for file in files:
                if ((file.split('.')[-1]) == 'txt'):
                    pyt_txt = os.path.join(rootdir, file)
                    Spisania_00 = pd.read_csv(pyt_txt, sep="\t", encoding='utf-8', skiprows=7,
                                              names=("–º–∞–≥–∞–∑–∏–Ω", "—Å–ø–∏—Å–∞–Ω–∏–µ_–±–µ–∑_—Ö–æ–∑–æ–≤_—Å_–Ω–¥—Å", "—Å–ø–∏—Å–∞–Ω–∏–µ_–±–µ–∑_—Ö–æ–∑–æ–≤_–±–µ–∑_–Ω–¥—Å"))
                    for i in tqdm(range(rng), desc="–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ç—Ç —Å–ø–∏—Å–∞–Ω–∏—è –±–µ–∑ —Ö–æ–∑–æ–≤ –Ω–¥—Å -" + file, ncols=120,
                                  colour="#F8C9CE"):
                        Spisania_00["–º–∞–≥–∞–∑–∏–Ω"] = Spisania_00["–º–∞–≥–∞–∑–∏–Ω"].replace(replacements["–ù–ê–ô–¢–ò"][i],
                                                                                replacements["–ó–ê–ú–ï–ù–ò–¢–¨"][i],
                                                                                regex=False)
                    date = file[0:len(file) - 4]
                    Spisania_00 = Spisania_00.loc[Spisania_00["–º–∞–≥–∞–∑–∏–Ω"] != "–ò—Ç–æ–≥–æ"]
                    Spisania_00["–¥–∞—Ç–∞"] = date
                    Spisania_00["–¥–∞—Ç–∞"] = pd.to_datetime(Spisania_00["–¥–∞—Ç–∞"], dayfirst=True)
                    Spisania = pd.concat([Spisania, Spisania_00], axis=0)
        Ren = ["—Å–ø–∏—Å–∞–Ω–∏–µ_–±–µ–∑_—Ö–æ–∑–æ–≤_—Å_–Ω–¥—Å", "—Å–ø–∏—Å–∞–Ω–∏–µ_–±–µ–∑_—Ö–æ–∑–æ–≤_–±–µ–∑_–Ω–¥—Å"]
        for r in Ren:
            Spisania[r] = Spisania[r].str.replace(',', '.')
            Spisania[r] = Spisania[r].str.replace('\xa0', '')
            Spisania[r] = Spisania[r].astype("float")
        Spisania["—Å—Ç–∞–≤–∫–∞ —Å–ø–∏—Å–∞–Ω–∏–µ –±–µ–∑ —Ö–æ–∑–æ–≤ –Ω–¥—Å"] = (Spisania["—Å–ø–∏—Å–∞–Ω–∏–µ_–±–µ–∑_—Ö–æ–∑–æ–≤_—Å_–Ω–¥—Å"] / Spisania["—Å–ø–∏—Å–∞–Ω–∏–µ_–±–µ–∑_—Ö–æ–∑–æ–≤_–±–µ–∑_–Ω–¥—Å"])
        Spisania["–ü–†–û–í–ï–†–ö–ê–ê"] = Spisania["—Å–ø–∏—Å–∞–Ω–∏–µ_–±–µ–∑_—Ö–æ–∑–æ–≤_—Å_–Ω–¥—Å"] * Spisania["—Å—Ç–∞–≤–∫–∞ —Å–ø–∏—Å–∞–Ω–∏–µ –±–µ–∑ —Ö–æ–∑–æ–≤ –Ω–¥—Å"]
        gc.enable()
        return Spisania
    '''–æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –∑–∞–≥—Ä—É–∑–∫—É –¥–∞–Ω–Ω—ã—Ö –¥–ª—è  —Ä–∞—Å—á–µ—Ç–∞ —Å—Ç–∞–≤–∫–∏ —Å–ø–∏—Å–∞–Ω–∏—è –±–µ–∑ —Ö–æ–∑–æ–≤ –Ω–¥—Å'''
    def NDS_pitanie(self):
        rng, replacements = RENAME().Rread()
        print("–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–∏—Ç–∞–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–ª–∞ –Ω–¥—Å\n")
        Pitanie = pd.DataFrame()
        for rootdir, dirs, files in os.walk(PUT + "–Ω–¥—Å_–ø–∏—Ç–∞–Ω–∏–µ_–ø–µ—Ä—Å–æ–Ω–∞–ª–∞\\"):
            for file in files:
                if ((file.split('.')[-1]) == 'txt'):
                    pyt_txt = os.path.join(rootdir, file)
                    Pitanie_00 = pd.read_csv(pyt_txt, sep="\t", encoding='utf-8', skiprows=7,
                                             names=("–º–∞–≥–∞–∑–∏–Ω", "–ø–∏—Ç–∞–Ω–∏–µ_–Ω–¥—Å", "2.10. –ü–∏—Ç–∞–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ "))
                    for i in tqdm(range(rng), desc="–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ç—Ç —Å–ø–∏—Å–∞–Ω–∏—è –±–µ–∑ —Ö–æ–∑–æ–≤ –Ω–¥—Å -" + file, ncols=120,
                                  colour="#F8C9CE"):
                        Pitanie_00["–º–∞–≥–∞–∑–∏–Ω"] = Pitanie_00["–º–∞–≥–∞–∑–∏–Ω"].replace(replacements["–ù–ê–ô–¢–ò"][i],
                                                                              replacements["–ó–ê–ú–ï–ù–ò–¢–¨"][i],
                                                                              regex=False)
                    date = file[0:len(file) - 4]
                    Pitanie_00 = Pitanie_00.loc[Pitanie_00["–º–∞–≥–∞–∑–∏–Ω"] != "–ò—Ç–æ–≥–æ"]
                    Pitanie_00["–¥–∞—Ç–∞"] = date
                    Pitanie_00["–¥–∞—Ç–∞"] = pd.to_datetime(Pitanie_00["–¥–∞—Ç–∞"], dayfirst=True)
                    Pitanie = pd.concat([Pitanie, Pitanie_00], axis=0)
        Ren = ["–ø–∏—Ç–∞–Ω–∏–µ_–Ω–¥—Å", "2.10. –ü–∏—Ç–∞–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ "]
        for r in Ren:
            Pitanie[r] = Pitanie[r].str.replace(',', '.')
            Pitanie[r] = Pitanie[r].str.replace('\xa0', '')
            Pitanie[r] = Pitanie[r].astype("float")
        Pitanie["–ø–∏—Ç–∞–Ω–∏–µ —Å—Ç–∞–≤–∫–∞ –Ω–¥—Å"] = (Pitanie["2.10. –ü–∏—Ç–∞–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ "] / Pitanie["–ø–∏—Ç–∞–Ω–∏–µ_–Ω–¥—Å"])
        Pitanie["–ü–†–û–í–ï–†–ö–ê–ê"] = Pitanie["–ø–∏—Ç–∞–Ω–∏–µ_–Ω–¥—Å"] * Pitanie["–ø–∏—Ç–∞–Ω–∏–µ —Å—Ç–∞–≤–∫–∞ –Ω–¥—Å"]
        gc.enable()
        return Pitanie"""
    '''–æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –∑–∞–≥—Ä—É–∑–∫—É –¥–∞–Ω–Ω—ã—Ö –¥–ª—è  —Ä–∞—Å—á–µ—Ç–∞ —Å—Ç–∞–≤–∫–∏ –ø–∏—Ç–∞–Ω–∏–µ —Å –Ω–¥—Å'''
    def NDS_zakup(self):
        rng, replacements = RENAME().Rread()
        print("–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∑–∞–∫—É–ø –Ω–¥—Å\n")
        Zakup = pd.DataFrame()
        for rootdir, dirs, files in os.walk(PUT + "–Ω–¥—Å_–∑–∞–∫—É–ø\\"):
            for file in files:
                if ((file.split('.')[-1]) == 'csv'):
                    pyt_txt = os.path.join(rootdir, file)
                    Zakup_00 = pd.read_csv(pyt_txt, sep=";", encoding='ANSI', skiprows=1,
                                           names=("–º–∞–≥–∞–∑–∏–Ω", "–ü–†–û–î–ê–ñ–ò –° –ù–î–°", "–ü–†–û–î–ê–ñ–ò –ë–ï–ó –ù–î–°", '—Å—Ç–∞–≤–∫–∞ –∑–∞–∫—É–ø –Ω–¥—Å'))
                    for i in tqdm(range(rng), desc="–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ç—Ç —Å–ø–∏—Å–∞–Ω–∏—è –±–µ–∑ —Ö–æ–∑–æ–≤ –Ω–¥—Å -" + file, ncols=120,
                                  colour="#F8C9CE"):
                        Zakup_00["–º–∞–≥–∞–∑–∏–Ω"] = Zakup_00["–º–∞–≥–∞–∑–∏–Ω"].replace(replacements["–ù–ê–ô–¢–ò"][i],
                                                                          replacements["–ó–ê–ú–ï–ù–ò–¢–¨"][i],
                                                                          regex=False)
                    Zakup_00['—Å—Ç–∞–≤–∫–∞ –∑–∞–∫—É–ø –Ω–¥—Å'] = Zakup_00['—Å—Ç–∞–≤–∫–∞ –∑–∞–∫—É–ø –Ω–¥—Å'].str.replace(',', '.')
                    Zakup_00['—Å—Ç–∞–≤–∫–∞ –∑–∞–∫—É–ø –Ω–¥—Å'] = Zakup_00['—Å—Ç–∞–≤–∫–∞ –∑–∞–∫—É–ø –Ω–¥—Å'].str.replace(' ', '')
                    Zakup_00['—Å—Ç–∞–≤–∫–∞ –∑–∞–∫—É–ø –Ω–¥—Å'] = Zakup_00['—Å—Ç–∞–≤–∫–∞ –∑–∞–∫—É–ø –Ω–¥—Å'].astype("float")
                    date = file[0:len(file) - 4]
                    Zakup_00 = Zakup_00.loc[Zakup_00["–º–∞–≥–∞–∑–∏–Ω"] != "–ò—Ç–æ–≥–æ"]
                    Zakup_00["–¥–∞—Ç–∞"] = date
                    Zakup_00["–¥–∞—Ç–∞"] = pd.to_datetime(Zakup_00["–¥–∞—Ç–∞"], dayfirst=True)
                    Zakup = pd.concat([Zakup, Zakup_00], axis=0)
                    gc.enable()
        return Zakup
    '''–æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –∑–∞–≥—Ä—É–∑–∫—É –¥–∞–Ω–Ω—ã—Ö –¥–ª—è  —Ä–∞—Å—á–µ—Ç–∞ —Å—Ç–∞–≤–∫–∏ –ø–∏—Ç–∞–Ω–∏–µ —Å –Ω–¥—Å'''
    def Stavka_nds_Kanal(self):
        Zakup = NEW().NDS_zakup()
        Dat_canal_nalg, finrez_max_month, finrez_max_data = NEW().Dat_nalog_kanal()
        sales = NEW().NDS_vir()
        print("—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã —Å—Ç–∞–≤–æ–∫ –Ω–¥—Å")

        # –æ–±—å–µ–¥–µ–Ω–µ–Ω–µ —Å—Ç–∞–≤–æ–∫ –Ω–¥—Å
        NDS = sales.drop(['–ü–†–û–î–ê–ñ–ò –° –ù–î–°', '–ü–†–û–î–ê–ñ–ò –ë–ï–ó –ù–î–°', '–ü–†–û–í–ï–†–ö–ê–ê'], axis=1)
        NDS["—Ö–æ–∑—ã —Å—Ç–∞–≤–∫–∞ –Ω–¥—Å"] = 0.80
        NDS = NDS.merge(Zakup[["–º–∞–≥–∞–∑–∏–Ω", "–¥–∞—Ç–∞", '—Å—Ç–∞–≤–∫–∞ –∑–∞–∫—É–ø –Ω–¥—Å']],
                        on=["–º–∞–≥–∞–∑–∏–Ω", "–¥–∞—Ç–∞"], how="left")
        # –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞ –Ω–∞–ª–æ–≥–æ–±–ª–æ–∂–µ–Ω–∏—è –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å—Ç–∞–≤–∫–∏ –Ω–∞ —É–ø—Ä–∞–µ–Ω–∫—É 1'''
        canal_nalog_maxdate = Dat_canal_nalg["–¥–∞—Ç–∞"].max()
        canal_nalog = Dat_canal_nalg.loc[Dat_canal_nalg['–¥–∞—Ç–∞'] == canal_nalog_maxdate]
        NDS = NDS.merge(
            Dat_canal_nalg[["–º–∞–≥–∞–∑–∏–Ω", '—Ä–µ–∂–∏–º –Ω–∞–ª–æ–≥–æ–æ–±–ª–æ–∂–µ–Ω–∏—è', '–∫–∞–Ω–∞–ª', '–∫–∞–Ω–∞–ª –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –∑–∞–∫—Ä—ã—Ç—ã–π –ø–µ—Ä–∏–æ–¥']],
            on=["–º–∞–≥–∞–∑–∏–Ω"], how="outer")
        NDS.loc[NDS['—Ä–µ–∂–∏–º –Ω–∞–ª–æ–≥–æ–æ–±–ª–æ–∂–µ–Ω–∏—è'] == "—É–ø—Ä–æ—â–µ–Ω–∫–∞", ['—Å—Ç–∞–≤–∫–∞ –≤—ã—Ä—É—á–∫–∞ –Ω–¥—Å', "—Ö–æ–∑—ã —Å—Ç–∞–≤–∫–∞ –Ω–¥—Å",'—Å—Ç–∞–≤–∫–∞ –∑–∞–∫—É–ø –Ω–¥—Å']] = [1, 1, 1]

        # —Ç–µ—Å—Ç–æ–≤—ã–π
        DOC().to_TEMP(x=NDS, name="FINREZ_Nalog_Kanal_test.csv")
        print("–°–æ—Ö—Ä–∞–Ω–µ–Ω - FINREZ_Nalog_Kanal_test.csv")
        return NDS
    '''–æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –æ–±—å–µ–¥–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞–≤–æ–∫ nds  –≤ –æ–¥–Ω—É —Ç–∞–±–ª–∏—Ü—É –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –Ω–∞–ª–æ–≥–∞ –¥–ª—è —É–ø—Ä–∞—â–µ–Ω–∫–∏'''
'''–æ—Ç–≤–µ—á–∞–µ—Ç –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –¥–∞—Ç—ã,
—Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–∏–µ –≤—Ä–µ–µ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ —Å –∫–∞–Ω–∞–ª–∞—Ç–∏ –∏ —Ä–µ–∂–∏–º–æ–º –Ω–∞–ª–æ–≥–æ–±–ª–æ–∂–µ–Ω–∏—è'''
class PROGNOZ:
    def SALES_obrabotka(self):
        gc.collect()
        Dat_canal_nalg, finrez_max_month, finrez_max_data = NEW().Dat_nalog_kanal()
        nds = NEW().Stavka_nds_Kanal()
        PROD_SVOD = pd.DataFrame()
        print("–û–ë–ù–û–í–õ–ï–ù–ò–ï –°–í–û–î–ù–û–ô –ü–†–û–î–ê–ñ")
        start = PUT_PROD
        for rootdir, dirs, files in os.walk(start):
            for file in tqdm(files, desc="–°–∫–ª–µ–∏–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö   --  ", ncols=120,colour="#F8C9CE"):
                if ((file.split('.')[-1]) == 'txt'):
                    pyt_txt = os.path.join(rootdir, file)
                    PROD_SVOD_00 = pd.read_csv(pyt_txt, sep="\t", encoding='utf-8', parse_dates=['–¥–∞—Ç–∞'],skiprows=1,low_memory=False,
                                                names=("–º–∞–≥–∞–∑–∏–Ω","–Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–∞","–¥–∞—Ç–∞","–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø—Ä–æ–¥–∞–∂",
                                                                     "–≤–µ—Å_–ø—Ä–æ–¥–∞–∂","–ó–∞–∫—É–ø —Ç–æ–≤–∞—Ä–∞ –æ–±—â–∏–π, —Ä—É–± —Å –ù–î–°", "–í—ã—Ä—É—á–∫–∞ –ò—Ç–æ–≥–æ, —Ä—É–± —Å –ù–î–°",
                                                "–ù–∞—Ü–µ–Ω–∫–∞ –û–±—â–∞—è, —Ä—É–± —Å –ù–î–°","–æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–ø–∏—Å–∞–Ω–∏—è", "–°–ø–∏—Å–†—É–±", "—Å–ø–∏—Å—Ä—É–±_—Å_–Ω–¥—Å"))
                    # –≤—ã–±–æ—Ä —Å—Ç–æ–ª–±—Ü–æ–≤ –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è
                    PROD_SVOD_00 = PROD_SVOD_00[["–¥–∞—Ç–∞", "–º–∞–≥–∞–∑–∏–Ω", "–Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–∞", "–í—ã—Ä—É—á–∫–∞ –ò—Ç–æ–≥–æ, —Ä—É–± —Å –ù–î–°",
                                                 "–ù–∞—Ü–µ–Ω–∫–∞ –û–±—â–∞—è, —Ä—É–± —Å –ù–î–°", "–ó–∞–∫—É–ø —Ç–æ–≤–∞—Ä–∞ –æ–±—â–∏–π, —Ä—É–± —Å –ù–î–°","–æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–ø–∏—Å–∞–Ω–∏—è","–°–ø–∏—Å–†—É–±","—Å–ø–∏—Å—Ä—É–±_—Å_–Ω–¥—Å"]]
                    PROD_SVOD_00[["–æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–ø–∏—Å–∞–Ω–∏—è","–º–∞–≥–∞–∑–∏–Ω","–Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–∞",]] = PROD_SVOD_00[["–æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–ø–∏—Å–∞–Ω–∏—è","–º–∞–≥–∞–∑–∏–Ω","–Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–∞",]].astype("str")
                    # —á–∏—Å—Ç–∫–∞ –æ—Ç –º—É—Å–æ—Ä–∞
                    # —É–¥–∞–ª–µ–Ω–∏–µ –º–∏–∫—Ä–æ–º–∞—Ä–∫–µ—Ç–æ–≤
                    l_mag = ("–ú–∏–∫—Ä–æ–º–∞—Ä–∫–µ—Ç","–≠–∫–æ–ø—É–Ω–∫—Ç", "–í–µ–Ω–¥–∏–Ω–≥")
                    for w in l_mag:
                        PROD_SVOD_00 = PROD_SVOD_00[~PROD_SVOD_00["–º–∞–≥–∞–∑–∏–Ω"].str.contains(w)]

                    lg = ("–í—ã—Ä—É—á–∫–∞ –ò—Ç–æ–≥–æ, —Ä—É–± —Å –ù–î–°","–ù–∞—Ü–µ–Ω–∫–∞ –û–±—â–∞—è, —Ä—É–± —Å –ù–î–°", "–ó–∞–∫—É–ø —Ç–æ–≤–∞—Ä–∞ –æ–±—â–∏–π, —Ä—É–± —Å –ù–î–°","–°–ø–∏—Å–†—É–±","—Å–ø–∏—Å—Ä—É–±_—Å_–Ω–¥—Å")
                    for e in lg:
                        PROD_SVOD_00[e] = (PROD_SVOD_00[e].astype(str)
                                           .str.replace("\xa0", "")
                                           .str.replace(",", ".")
                                           .fillna("0")
                                           .astype(float)
                                           .round(2))
                    PODAROK = ("–ü–æ–¥–∞—Ä–æ—á–Ω–∞—è –∫–∞—Ä—Ç–∞ –ö–ú 500—Ä+ –∫–æ–Ω–≤–µ—Ä—Ç", "–ü–æ–¥–∞—Ä–æ—á–Ω–∞—è –∫–∞—Ä—Ç–∞ –ö–ú 1000—Ä+ –∫–æ–Ω–≤–µ—Ä—Ç",
                                   "–ø–æ–¥–∞—Ä–æ—á–Ω–∞—è –∫–∞—Ä—Ç–∞ –ö–ú 500 –ù–û–í–ê–Ø",
                                   "–ø–æ–¥–∞—Ä–æ—á–Ω–∞—è –∫–∞—Ä—Ç–∞ –ö–ú 1000 –ù–û–í–ê–Ø")
                    for x in PODAROK:
                        PROD_SVOD_00 = PROD_SVOD_00[~PROD_SVOD_00['–Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–∞'].str.contains(x)]

                    PROD_SVOD = pd.concat([PROD_SVOD, PROD_SVOD_00], axis=0)
        PROD_SVOD = PROD_SVOD.reset_index(drop=True)
        gc.collect()
        # region –ë–û–¢
        PROD_SVOD_BOT = PROD_SVOD[["–¥–∞—Ç–∞", "–º–∞–≥–∞–∑–∏–Ω", "–í—ã—Ä—É—á–∫–∞ –ò—Ç–æ–≥–æ, —Ä—É–± —Å –ù–î–°", "–Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–∞", "–°–ø–∏—Å–†—É–±", "–æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–ø–∏—Å–∞–Ω–∏—è"]]
        PROD_SVOD = PROD_SVOD.drop(columns={"–°–ø–∏—Å–†—É–±"})
        # —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–∏–µ —Ç–æ–ª—å–∫–æ —Ö–æ–∑—ã
        BOT_NUM_HOZ = PROD_SVOD_BOT.loc[PROD_SVOD_BOT["–æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–ø–∏—Å–∞–Ω–∏—è"] == "–•–æ–∑—è–π—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã"]
        BOT_NUM_HOZ = BOT_NUM_HOZ.drop(columns={"–í—ã—Ä—É—á–∫–∞ –ò—Ç–æ–≥–æ, —Ä—É–± —Å –ù–î–°","–æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–ø–∏—Å–∞–Ω–∏—è"})
        DOC().to_TEMP(x=BOT_NUM_HOZ,name="BOT\\BOT_–•–æ–∑—ã.csv")
        # —Å–æ—Ö–æ–∞–Ω–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –ø–æ—Ç–µ—Ä–∏
        BOT_POTER = PROD_SVOD_BOT.loc[PROD_SVOD_BOT["–æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–ø–∏—Å–∞–Ω–∏—è"] == "–ü–û–¢–ï–†–ò"]
        BOT_POTER = BOT_POTER.drop(columns={"–í—ã—Ä—É—á–∫–∞ –ò—Ç–æ–≥–æ, —Ä—É–± —Å –ù–î–°", "–æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–ø–∏—Å–∞–Ω–∏—è"})
        DOC().to_TEMP(x=BOT_POTER, name="BOT\\–ü–æ—Ç–µ—Ä–∏.csv")
        # —Å–æ—Ö–æ–∞–Ω–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –º–∞–≥–∞–∑–∏–Ω—ã
        BOT_Mag_UNIK = PROD_SVOD_BOT["–º–∞–≥–∞–∑–∏–Ω"].unique()
        BOT_Mag_UNIK = pd.DataFrame({'–º–∞–≥–∞–∑–∏–Ω': BOT_Mag_UNIK})
        DOC().to_TEMP(x=BOT_Mag_UNIK , name="BOT\\–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –º–∞–≥–∞–∑–∏–Ω—ã.csv")
        # –¥–ª—è –≥—Ä—É–ø–∏—Ä–æ–≤–∫–∏ –æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞–º
        PROD_SVOD_BOT = PROD_SVOD_BOT [["–¥–∞—Ç–∞", "–º–∞–≥–∞–∑–∏–Ω", "–í—ã—Ä—É—á–∫–∞ –ò—Ç–æ–≥–æ, —Ä—É–± —Å –ù–î–°","–°–ø–∏—Å–†—É–±" ]]
        PROD_SVOD_BOT = PROD_SVOD_BOT.groupby(["–¥–∞—Ç–∞", "–º–∞–≥–∞–∑–∏–Ω"]).sum().reset_index()
        DOC().to_TEMP(x=PROD_SVOD_BOT, name="BOT_TEMP.csv")
        BOT().to_day()
        # end region
        # region –§–ò–õ–¨–¢–†–ê–¶–ò–Ø –¢–ê–ë–õ–ò–¶–´ > –ú–ê–ö–° –î–ê–¢–´ –§–∞–∫—Ç–∞ –§–ò–ù–†–ï–ó–ê
        PROD_SVOD["–º–µ—Å—è—Ü"] = PROD_SVOD["–¥–∞—Ç–∞"]
        PROD_SVOD.loc[~PROD_SVOD["–º–µ—Å—è—Ü"].dt.is_month_start, "–º–µ—Å—è—Ü"] = PROD_SVOD["–º–µ—Å—è—Ü"] - MonthBegin()
        PROD_SVOD["–Ω–æ–º–µ—Ä –º–µ—Å—è—Ü–∞"] = PROD_SVOD["–¥–∞—Ç–∞"].dt.month
        PROD_SVOD = PROD_SVOD.loc[PROD_SVOD["–Ω–æ–º–µ—Ä –º–µ—Å—è—Ü–∞"] > finrez_max_month]
        PROD_SVOD = PROD_SVOD.reset_index(drop=True)
        # endregion

        # –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–æ–≤ –ó–∞—Ç—Ä–∞—Ç
        PROD_SVOD.loc[PROD_SVOD["–æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–ø–∏—Å–∞–Ω–∏—è"] ==  "–•–æ–∑—è–π—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã", "2.6. –•–æ–∑—è–π—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã" ] = PROD_SVOD["—Å–ø–∏—Å—Ä—É–±_—Å_–Ω–¥—Å"]
        PROD_SVOD.loc[PROD_SVOD["–æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–ø–∏—Å–∞–Ω–∏—è"] ==  "–ü–∏—Ç–∞–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤", "2.10. –ü–∏—Ç–∞–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ " ] = PROD_SVOD["—Å–ø–∏—Å—Ä—É–±_—Å_–Ω–¥—Å"]
        PROD_SVOD.loc[(PROD_SVOD["–æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–ø–∏—Å–∞–Ω–∏—è"] == "–ü–û–¢–ï–†–ò") |
                      (PROD_SVOD["–æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–ø–∏—Å–∞–Ω–∏—è"] == "–î–µ–≥—É—Å—Ç–∞—Ü–∏–∏") |
                      (PROD_SVOD["–æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–ø–∏—Å–∞–Ω–∏—è"] == "–ö—Ä–∞–∂–∏") |
                      (PROD_SVOD["–æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–ø–∏—Å–∞–Ω–∏—è"] == "–ü–æ–¥–∞—Ä–æ–∫ –ø–æ–∫—É–ø–∞—Ç–µ–ª—é (—Å–µ—Ä–≤–∏—Å–Ω–∞—è —Ñ–∏—à–∫–∞)") |
                      (PROD_SVOD["–æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–ø–∏—Å–∞–Ω–∏—è"] == "–ú–ê–†–ö–ï–¢–ò–ù–ì (–±–ª–æ–≥–µ—Ä—ã, —Ñ–æ—Ç–æ—Å–µ—Å—Å–∏–∏)") |
                      (PROD_SVOD["–æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–ø–∏—Å–∞–Ω–∏—è"] == "–ü–æ–¥–∞—Ä–æ–∫ –ø–æ–∫—É–ø–∞—Ç–µ–ª—é (–±–æ–Ω—É—Å—ã)") |
                      (PROD_SVOD["–æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–ø–∏—Å–∞–Ω–∏—è"] == "–ü–∏—Ç–∞–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤"), "2.5.1. –°–ø–∏—Å–∞–Ω–∏–µ –ø–æ—Ç–µ—Ä—å (–¥–æ –Ω–æ—è–±—Ä—è 19–≥ –ù–ï–£ + –°–ø–∏—Å–∞–Ω–∏–µ –ø–æ—Ç–µ—Ä—å)"] = PROD_SVOD["—Å–ø–∏—Å—Ä—É–±_—Å_–Ω–¥—Å"]
        PROD_SVOD = PROD_SVOD.drop(columns={"–Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–∞", "—Å–ø–∏—Å—Ä—É–±_—Å_–Ω–¥—Å", "–Ω–æ–º–µ—Ä –º–µ—Å—è—Ü–∞", "–¥–∞—Ç–∞"})
        PROD_SVOD = PROD_SVOD.rename(columns={"–º–µ—Å—è—Ü": "–¥–∞—Ç–∞"})
        PROD_SVOD = PROD_SVOD.merge(nds, on=["–º–∞–≥–∞–∑–∏–Ω"], how="left")
        print(PROD_SVOD)
        print(nds)
        PROD_SVOD['–í—ã—Ä—É—á–∫–∞ –ò—Ç–æ–≥–æ, —Ä—É–± –±–µ–∑ –ù–î–°'] = 0
        PROD_SVOD['2.5.2. –ù–ï–£'] = PROD_SVOD["2.5.1. –°–ø–∏—Å–∞–Ω–∏–µ –ø–æ—Ç–µ—Ä—å (–¥–æ –Ω–æ—è–±—Ä—è 19–≥ –ù–ï–£ + –°–ø–∏—Å–∞–Ω–∏–µ –ø–æ—Ç–µ—Ä—å)"] * 0.15
        PROD_SVOD['2.9. –ù–∞–ª–æ–≥–∏'] = np.nan
        PROD_SVOD['2.4.–£—Å–ª—É–≥–∏ –±–∞–Ω–∫–∞'] = np.nan




        # DOC().to_TEMP(x=PROD_SVOD, name="–í—Ä–µ–º–µ–Ω–Ω—ã–π —Ñ–∞–π–ª_–ø—Ä–æ–¥–∞–∂.csv")
        # region –î–õ–Ø –ë–û–¢–ê

        # endregion
        gc.collect()


        # region –ì–†–£–ü–ü–ò–†–û–í–ö–ê –¢–ê–ë–õ–ò–¶–´(–ë–µ–∑ –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä—ã –ø–æ –¥–Ω—è–º)



        PROD_SVOD = PROD_SVOD.groupby(["–¥–∞—Ç–∞", "–º–∞–≥–∞–∑–∏–Ω"], as_index=False) \
            .aggregate({"–í—ã—Ä—É—á–∫–∞ –ò—Ç–æ–≥–æ, —Ä—É–± —Å –ù–î–°": "sum",
                        "–ù–∞—Ü–µ–Ω–∫–∞ –û–±—â–∞—è, —Ä—É–± —Å –ù–î–°": "sum",
                        "2.5.1. –°–ø–∏—Å–∞–Ω–∏–µ –ø–æ—Ç–µ—Ä—å (–¥–æ –Ω–æ—è–±—Ä—è 19–≥ –ù–ï–£ + –°–ø–∏—Å–∞–Ω–∏–µ –ø–æ—Ç–µ—Ä—å)": "sum",
                        "2.5.2. –ù–ï–£":"sum",
                        "2.9. –ù–∞–ª–æ–≥–∏":"sum",
                        "2.4.–£—Å–ª—É–≥–∏ –±–∞–Ω–∫–∞":"sum",
                        "2.6. –•–æ–∑—è–π—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã": "sum",
                        "–ó–∞–∫—É–ø —Ç–æ–≤–∞—Ä–∞ –æ–±—â–∏–π, —Ä—É–± —Å –ù–î–°": "sum",
                        "2.10. –ü–∏—Ç–∞–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ ": "sum"}) \
            .sort_values("–¥–∞—Ç–∞", ascending=False)
        PROD_SVOD = PROD_SVOD.reset_index()
        print(PROD_SVOD)
        # endregion
        # region –§–ò–õ–¨–¢–†–ê–¶–ò–Ø –¢–ê–ë–õ–ò–¶–´ > –ú–ê–ö–° –î–ê–¢–´ –ö–ê–õ–ï–ù–î–ê–†–Ø –ò –≤—ã—Ä—É—á–∫–∞ > 0
        PROD_SVOD = PROD_SVOD.loc[PROD_SVOD["–í—ã—Ä—É—á–∫–∞ –ò—Ç–æ–≥–æ, —Ä—É–± —Å –ù–î–°"] > 0]
        PROD_SVOD["–º–µ—Å—è—Ü"] = PROD_SVOD["–¥–∞—Ç–∞"]
        PROD_SVOD.loc[~PROD_SVOD["–º–µ—Å—è—Ü"].dt.is_month_start, "–º–µ—Å—è—Ü"] = PROD_SVOD["–º–µ—Å—è—Ü"] - MonthBegin()
        PROD_SVOD["–Ω–æ–º–µ—Ä –º–µ—Å—è—Ü–∞"] = PROD_SVOD["–¥–∞—Ç–∞"].dt.month
        PROD_SVOD = PROD_SVOD.loc[PROD_SVOD["–Ω–æ–º–µ—Ä –º–µ—Å—è—Ü–∞"] > finrez_max_month]
        PROD_SVOD = PROD_SVOD.reset_index(drop=True)
        # endregion
        # region –ì–†–£–ü–ò–†–û–í–ö–ê –ü–û –ú–ï–°–Ø–¶–ê–ú
        PROD_SVOD = PROD_SVOD.groupby(["–º–µ—Å—è—Ü", "–º–∞–≥–∞–∑–∏–Ω"], as_index=False) \
            .aggregate(
            {"–¥–∞—Ç–∞": "nunique", "–í—ã—Ä—É—á–∫–∞ –ò—Ç–æ–≥–æ, —Ä—É–± —Å –ù–î–°": "sum",
             "–ù–∞—Ü–µ–Ω–∫–∞ –û–±—â–∞—è, —Ä—É–± —Å –ù–î–°": "sum",
             "2.5.1. –°–ø–∏—Å–∞–Ω–∏–µ –ø–æ—Ç–µ—Ä—å (–¥–æ –Ω–æ—è–±—Ä—è 19–≥ –ù–ï–£ + –°–ø–∏—Å–∞–Ω–∏–µ –ø–æ—Ç–µ—Ä—å)": "sum", "2.6. –•–æ–∑—è–π—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã": "sum",
             "–ó–∞–∫—É–ø —Ç–æ–≤–∞—Ä–∞ –æ–±—â–∏–π, —Ä—É–± —Å –ù–î–°": "sum"}) \
            .sort_values("–º–∞–≥–∞–∑–∏–Ω", ascending=False)

        PROD_SVOD = PROD_SVOD.rename(columns={'–¥–∞—Ç–∞': "—Ñ–∞–∫—Ç –æ—Ç—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –¥–Ω–µ–π"})
        PROD_SVOD = PROD_SVOD.rename(columns={'–º–µ—Å—è—Ü': '–¥–∞—Ç–∞'})
        # endregion
        # redion –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∞–≤–∫–∏ –Ω–¥—Å –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –≤—ã—Ä—É—á–∫–∏ –±–µ–∑ –Ω–¥—Å
        nds = NEW().Stavka_nds_Kanal()
        PROD_SVOD = PROD_SVOD.merge(nds, on=["–¥–∞—Ç–∞", "–º–∞–≥–∞–∑–∏–Ω"], how="left")
        PROD_SVOD["–í—ã—Ä—É—á–∫–∞ –ò—Ç–æ–≥–æ, —Ä—É–± –±–µ–∑ –ù–î–°"] = PROD_SVOD["–í—ã—Ä—É—á–∫–∞ –ò—Ç–æ–≥–æ, —Ä—É–± —Å –ù–î–°"] * PROD_SVOD[
            "—Å—Ç–∞–≤–∫–∞ –≤—ã—Ä—É—á–∫–∞ –Ω–¥—Å"]
        PROD_SVOD["–ó–∞–∫—É–ø —Ç–æ–≤–∞—Ä–∞ –æ–±—â–∏–π, —Ä—É–± –±–µ–∑ –ù–î–°"] = PROD_SVOD["–ó–∞–∫—É–ø —Ç–æ–≤–∞—Ä–∞ –æ–±—â–∏–π, —Ä—É–± —Å –ù–î–°"] * PROD_SVOD['—Å—Ç–∞–≤–∫–∞ –∑–∞–∫—É–ø –Ω–¥—Å']
        PROD_SVOD["2.5.1. –°–ø–∏—Å–∞–Ω–∏–µ –ø–æ—Ç–µ—Ä—å (–¥–æ –Ω–æ—è–±—Ä—è 19–≥ –ù–ï–£ + –°–ø–∏—Å–∞–Ω–∏–µ –ø–æ—Ç–µ—Ä—å)"] = PROD_SVOD["2.5.1. –°–ø–∏—Å–∞–Ω–∏–µ –ø–æ—Ç–µ—Ä—å (–¥–æ –Ω–æ—è–±—Ä—è 19–≥ –ù–ï–£ + –°–ø–∏—Å–∞–Ω–∏–µ –ø–æ—Ç–µ—Ä—å)"] * PROD_SVOD['—Å—Ç–∞–≤–∫–∞ —Å–ø–∏—Å–∞–Ω–∏–µ –±–µ–∑ —Ö–æ–∑–æ–≤ –Ω–¥—Å']

        PROD_SVOD["2.6. –•–æ–∑—è–π—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã"] = PROD_SVOD["2.6. –•–æ–∑—è–π—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã"] * PROD_SVOD["—Ö–æ–∑—ã —Å—Ç–∞–≤–∫–∞ –Ω–¥—Å"]
        PROD_SVOD = PROD_SVOD.reset_index(drop=True)
        # –∏—Å–∫–ª—é—á–µ–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–æ–≤ –ª—è –æ–∫—Ä—É–≥–ª–µ–Ω–∏—è
        ne_col = ['–¥–∞—Ç–∞', '–º–∞–≥–∞–∑–∏–Ω', '—Ñ–∞–∫—Ç –æ—Ç—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –¥–Ω–µ–π', '—Ä–µ–∂–∏–º –Ω–∞–ª–æ–≥–æ–æ–±–ª–æ–∂–µ–Ω–∏—è', '–∫–∞–Ω–∞–ª', '–∫–∞–Ω–∞–ª –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –∑–∞–∫—Ä—ã—Ç—ã–π –ø–µ—Ä–∏–æ–¥']
        okrugl = [col for col in PROD_SVOD.columns if col not in ne_col]
        # –æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ
        PROD_SVOD[okrugl] = PROD_SVOD[okrugl].round(2)


        gc.collect()
        return PROD_SVOD
    def Sales_prognoz(self):
        PROD_SVOD = pd.read_csv(PUT + "TEMP\\" + "–í—Ä–µ–º–µ–Ω–Ω—ã–π —Ñ–∞–π–ª_–ø—Ä–æ–¥–∞–∂.csv",
                                sep=";", encoding='ANSI', parse_dates=['–¥–∞—Ç–∞'])
        print("—Ä–∞—Å—á–µ—Ç –ø—Ä–æ–≥–Ω–æ–∑–∞ –ø—Ä–æ–¥–∞–∂")
        # region –î–û–ë–ê–í–õ–ï–ù–ò–ï –î–ê–ù–ù–´–• –ö–ê–õ–ï–ù–î–ê–†–Ø
        Calendar = pd.read_excel(PUT + "DATA_2\\–ö–∞–ª–µ–Ω–¥–∞—Ä—å.xlsx", sheet_name="Query1")
        Calendar.loc[~Calendar["–¥–∞—Ç–∞"].dt.is_month_start, "–¥–∞—Ç–∞"] = Calendar["–¥–∞—Ç–∞"] - MonthBegin()
        Calendar = Calendar.groupby(["–ì–û–î", "–ù–û–ú–ï–† –ú–ï–°–Ø–¶–ê", "–¥–∞—Ç–∞"], as_index=False) \
            .aggregate({'–î–ù–ï–ô –í –ú–ï–°–Ø–¶–ï': "max"}) \
            .sort_values("–ì–û–î", ascending=False)
        PROD_SVOD = PROD_SVOD.rename(columns={'–°–∫–ª–∞–¥ –º–∞–≥–∞–∑–∏–Ω.–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ': "!–ú–ê–ì–ê–ó–ò–ù!"})
        PROD_SVOD = PROD_SVOD.rename(columns={'–ú–µ—Å—è—Ü': '–¥–∞—Ç–∞'})
        PROD_SVOD = PROD_SVOD.merge(Calendar, on=["–¥–∞—Ç–∞"], how="left")
        PROD_SVOD["–û—Å—Ç–∞–ª–æ—Å—å –¥–Ω–µ–π –ø—Ä–æ–¥–∞–∂"] = PROD_SVOD["–î–ù–ï–ô –í –ú–ï–°–Ø–¶–ï"] - PROD_SVOD["—Ñ–∞–∫—Ç –æ—Ç—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –¥–Ω–µ–π"]
        dd = PROD_SVOD.groupby('–¥–∞—Ç–∞')['–û—Å—Ç–∞–ª–æ—Å—å –¥–Ω–µ–π –ø—Ä–æ–¥–∞–∂'].aggregate('min')
        PROD_SVOD = PROD_SVOD.merge(dd, on=["–¥–∞—Ç–∞"], how="left")
        PROD_SVOD.loc[
            PROD_SVOD["–û—Å—Ç–∞–ª–æ—Å—å –¥–Ω–µ–π –ø—Ä–æ–¥–∞–∂_x"] > PROD_SVOD["–û—Å—Ç–∞–ª–æ—Å—å –¥–Ω–µ–π –ø—Ä–æ–¥–∞–∂_y"], '–û—Å—Ç–∞–ª–æ—Å—å –¥–Ω–µ–π –ø—Ä–æ–¥–∞–∂_x'] = \
        PROD_SVOD["–û—Å—Ç–∞–ª–æ—Å—å –¥–Ω–µ–π –ø—Ä–æ–¥–∞–∂_y"]
        PROD_SVOD = PROD_SVOD.drop(columns={"–û—Å—Ç–∞–ª–æ—Å—å –¥–Ω–µ–π –ø—Ä–æ–¥–∞–∂_y", "–ù–û–ú–ï–† –ú–ï–°–Ø–¶–ê", "–ì–û–î"})
        PROD_SVOD = PROD_SVOD.rename(columns={'–û—Å—Ç–∞–ª–æ—Å—å –¥–Ω–µ–π –ø—Ä–æ–¥–∞–∂_x': "–û—Å—Ç–∞–ª–æ—Å—å –¥–Ω–µ–π –ø—Ä–æ–¥–∞–∂"})

        # region –î–û–ë–ê–í–õ–ï–ù–ò–ï –ö–ê–ù–ê–õ–û–í –û–ë–û–ë–©–ê–Æ–©–ò–• –í –¢–ê–ë–õ–ò–¶–£ –ü–†–û–î–ê–ñ
        #canal = pd.read_excel(PUT + "DATA_2\\" + "–ö–∞–Ω–∞–ª—ã.xlsx", sheet_name="–õ–∏—Å—Ç1")
        #canal["–¥–∞—Ç–∞"] = canal["–¥–∞—Ç–∞"].astype("datetime64[ns]")
        #PROD_SVOD = pd.concat([PROD_SVOD, canal], axis=0)
        #PROD_SVOD = PROD_SVOD.reset_index(drop=True)
        # endregion
        # region –†–ê–ó–í–û–†–û–¢ –¢–ê–ë–õ–ò–¶–´ –ü–†–û–î–ê–ñ
        PROD_SVOD = PROD_SVOD.drop(columns={"—Å—Ç–∞–≤–∫–∞ –≤—ã—Ä—É—á–∫–∞ –Ω–¥—Å", "—Å—Ç–∞–≤–∫–∞ —Å–ø–∏—Å–∞–Ω–∏–µ –±–µ–∑ —Ö–æ–∑–æ–≤ –Ω–¥—Å", "–ø–∏—Ç–∞–Ω–∏–µ —Å—Ç–∞–≤–∫–∞ –Ω–¥—Å","—Ö–æ–∑—ã —Å—Ç–∞–≤–∫–∞ –Ω–¥—Å","—Å—Ç–∞–≤–∫–∞ –∑–∞–∫—É–ø –Ω–¥—Å",})
        PROD_SVOD = PROD_SVOD.melt(
            id_vars=["–¥–∞—Ç–∞", "–º–∞–≥–∞–∑–∏–Ω", "–î–ù–ï–ô –í –ú–ï–°–Ø–¶–ï", "–û—Å—Ç–∞–ª–æ—Å—å –¥–Ω–µ–π –ø—Ä–æ–¥–∞–∂", "—Ñ–∞–∫—Ç –æ—Ç—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –¥–Ω–µ–π","—Ä–µ–∂–∏–º –Ω–∞–ª–æ–≥–æ–æ–±–ª–æ–∂–µ–Ω–∏—è","–∫–∞–Ω–∞–ª","–∫–∞–Ω–∞–ª –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –∑–∞–∫—Ä—ã—Ç—ã–π –ø–µ—Ä–∏–æ–¥"])
        PROD_SVOD = PROD_SVOD.rename(columns={"variable": "c—Ç–∞—Ç—å—è", "value": "–∑–Ω–∞—á–µ–Ω–∏–µ"})
        # endregion
        PROD_SVOD["–∑–Ω–∞—á–µ–Ω–∏–µ"] = PROD_SVOD["–∑–Ω–∞—á–µ–Ω–∏–µ"].astype("float")
        PROD_SVOD["—Ñ–∞–∫—Ç –æ—Ç—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –¥–Ω–µ–π"] = PROD_SVOD["—Ñ–∞–∫—Ç –æ—Ç—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –¥–Ω–µ–π"].astype("float")
        # region –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥–Ω–æ–∑–∞

        PROD_SVOD = PROD_SVOD.rename(columns={"–∑–Ω–∞—á–µ–Ω–∏–µ": "–∑–Ω–∞—á–µ–Ω–∏–µ_—Ñ–∞–∫—Ç" })
        PROD_SVOD["–∑–Ω–∞—á–µ–Ω–∏–µ"] = ((PROD_SVOD["–∑–Ω–∞—á–µ–Ω–∏–µ_—Ñ–∞–∫—Ç"] / PROD_SVOD["—Ñ–∞–∫—Ç –æ—Ç—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –¥–Ω–µ–π"]) * PROD_SVOD[
            "–û—Å—Ç–∞–ª–æ—Å—å –¥–Ω–µ–π –ø—Ä–æ–¥–∞–∂"]) + PROD_SVOD["–∑–Ω–∞—á–µ–Ω–∏–µ_—Ñ–∞–∫—Ç"]
        PROD_SVOD[["–∑–Ω–∞—á–µ–Ω–∏–µ","–∑–Ω–∞—á–µ–Ω–∏–µ_—Ñ–∞–∫—Ç"]] = PROD_SVOD[["–∑–Ω–∞—á–µ–Ω–∏–µ","–∑–Ω–∞—á–µ–Ω–∏–µ_—Ñ–∞–∫—Ç"]].round(2)
        # endregion
        PROD_SVOD_00 = PROD_SVOD.groupby(["–º–∞–≥–∞–∑–∏–Ω", "–¥–∞—Ç–∞"])['–∫–∞–Ω–∞–ª'].nunique().reset_index()
        PROD_SVOD_00 = PROD_SVOD_00.rename(columns={'–∫–∞–Ω–∞–ª': '–∫–∞–Ω–∞–ª_–∫–æ–ª', })
        PROD_SVOD = pd.merge(PROD_SVOD, PROD_SVOD_00[['–º–∞–≥–∞–∑–∏–Ω', '–¥–∞—Ç–∞', '–∫–∞–Ω–∞–ª_–∫–æ–ª']], on=['–º–∞–≥–∞–∑–∏–Ω', '–¥–∞—Ç–∞'], how='left')
        sp  = ["–í—ã—Ä—É—á–∫–∞ –ò—Ç–æ–≥–æ, —Ä—É–± –±–µ–∑ –ù–î–°", "–ó–∞–∫—É–ø —Ç–æ–≤–∞—Ä–∞ (–ú–ö–ü, –ö–ü, —Å–æ–ø—É—Ç–∫–∞), —Ä—É–± –±–µ–∑ –ù–î–°", "2.5.1. –°–ø–∏—Å–∞–Ω–∏–µ –ø–æ—Ç–µ—Ä—å (–¥–æ –Ω–æ—è–±—Ä—è 19–≥ –ù–ï–£ + –°–ø–∏—Å–∞–Ω–∏–µ –ø–æ—Ç–µ—Ä—å)", "2.5.2. –ù–ï–£","2.6. –•–æ–∑—è–π—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã"]
        for i in sp:
            PROD_SVOD.loc[(PROD_SVOD["–∫–∞–Ω–∞–ª"] == "–§–†–°") & (
                    PROD_SVOD['–∫–∞–Ω–∞–ª_–∫–æ–ª'] == 2) & (PROD_SVOD["c—Ç–∞—Ç—å—è"] == i), "–∑–Ω–∞—á–µ–Ω–∏–µ" ] = 0
        #PROD_SVOD = PROD_SVOD.drop(columns={"–î–ù–ï–ô –í –ú–ï–°–Ø–¶–ï"," –∫–∞–Ω–∞–ª_–∫–æ–ª", "–ì–û–î"})
        DOC().to_TEMP(x=PROD_SVOD, name="PROD_SVOD_PROGNOZ_TEMP.csv")
        return PROD_SVOD
    """—Ñ—É–Ω–∫—Ü–∏—è –∑–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –¥–∞–Ω–Ω—ã—Ö"""
"""–æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—É—Ç–∏ –ø—Ä–æ–¥–∞–∂ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ, –≥—Ä—É–ø–∏—Ä–æ–≤–∫–∞ —Ç–∞–±–ª–∏—Ü"""

"""BOT().bot_mes_analitik(mes=f"–î–∞—à–±–æ—Ä–¥ –æ–±–Ω–æ–≤–ª–µ–Ω:\n"
                  f"–î–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞:\n"
                  f"–°–ü–ò–°–ê–ù–ò–Ø\n"
                  f"–ù–∞ –Ω–æ–≤–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å\n"
                  f"–°–ø–∏—Å–∞–Ω–∏—è –ø–æ —Å—Ç–∞—Ç—å—è–º\n"
                  f"    - –ü–æ—Ç–µ—Ä–∏\n"
                  f"    - –ö—Ä–∞–∂–∏\n"
                  f"    - –ü–∏—Ç–∞–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–ª–∞\n"
                  f"    - –ú–∞—Ä–∫–µ—Ç–∏–Ω–≥\n"
                  f"    - –ü–æ–¥–∞—Ä–æ–∫ –ø–æ–∫—É–ø–∞—Ç–µ–ª—é(–±–æ–Ω—É—Å—ã)\n"
                  f"    - –ü–æ–¥–∞—Ä–æ–∫ –ø–æ–∫—É–ø–∞—Ç–µ–ª—é(–°–µ—Ä–≤–∏—Å–Ω–∞—è —Ñ–∏—à–∫–∞)\n"
                  f"    - –•–æ–∑—ã\n"
                  f"–í—Å–µ –º–æ–∂–Ω–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø–æ –¥–Ω—è–º, –Ω–µ–¥–µ–ª—è–º\n"
                  f"–º–µ—Å—è—Ü–∞–º, –∫–≤–∞—Ä—Ç–∞–ª–∞–º –∏ –≥–æ–¥–∞–º\n\n"
                  f"–ü–æ–∫–∞ —á—Ç–æ –≤—Å–µ.")"""
"""–æ–æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –≥—Ä—É–ø–ø—É –∞–Ω–∞–ª–∏—Ç–∏–∫"""

#NEW().Stavka_nds_Kanal()
#NEW().Finrez()
#NEW().Obnovlenie_error()
#NEW().Obnovlenie()
BOT().to_day()
#BOT().open_ai_curi()
#PROGNOZ().SALES_obrabotka()
#PROGNOZ().Sales_prognoz()